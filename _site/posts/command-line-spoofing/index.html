<!doctype html>














<!-- `site.alt_lang` can specify a language different from the UI -->
<html lang="en" >
  <head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7">
  <meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta
    name="viewport"
    content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover"
  ><!-- Setup Open Graph image -->

  

  <!-- Begin Jekyll SEO tag v2.8.0 -->
<meta name="generator" content="Jekyll v4.3.3" />
<meta property="og:title" content="Command Line Spoofing" />
<meta property="og:locale" content="en" />
<meta name="description" content="Command line spoofing is a technique where the instructions given to a program through the command line are altered or replaced. To make this clearer, let’s break it down:" />
<meta property="og:description" content="Command line spoofing is a technique where the instructions given to a program through the command line are altered or replaced. To make this clearer, let’s break it down:" />
<link rel="canonical" href="http://localhost:4000/posts/command-line-spoofing/" />
<meta property="og:url" content="http://localhost:4000/posts/command-line-spoofing/" />
<meta property="og:site_name" content="Utsab Adhikari" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2024-07-30T15:34:00+05:45" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Command Line Spoofing" />
<meta name="twitter:site" content="@twitter_username" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2024-08-11T01:31:34+05:45","datePublished":"2024-07-30T15:34:00+05:45","description":"Command line spoofing is a technique where the instructions given to a program through the command line are altered or replaced. To make this clearer, let’s break it down:","headline":"Command Line Spoofing","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/posts/command-line-spoofing/"},"url":"http://localhost:4000/posts/command-line-spoofing/"}</script>
<!-- End Jekyll SEO tag -->


  <title>Command Line Spoofing | Utsab Adhikari
  </title>

  <!--
  The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps
  Generated by: https://realfavicongenerator.net/
-->



<link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png">

  <link rel="manifest" href="/assets/img/favicons/site.webmanifest">

<link rel="shortcut icon" href="/assets/img/favicons/favicon.ico">
<meta name="apple-mobile-web-app-title" content="Utsab Adhikari">
<meta name="application-name" content="Utsab Adhikari">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml">
<meta name="theme-color" content="#ffffff">


  <!-- Resource Hints -->
  
    
      
        <link rel="preconnect" href="https://fonts.googleapis.com" >
      
        <link rel="dns-prefetch" href="https://fonts.googleapis.com" >
      
    
      
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
      
        <link rel="dns-prefetch" href="https://fonts.gstatic.com" >
      
    
      
        <link rel="preconnect" href="https://cdn.jsdelivr.net" >
      
        <link rel="dns-prefetch" href="https://cdn.jsdelivr.net" >
      
    
  

  <!-- Bootstrap -->
  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">
  

  <!-- Theme style -->
  <link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css">

  <!-- Web Font -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400&family=Source+Sans+Pro:wght@400;600;700;900&display=swap">

  <!-- Font Awesome Icons -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.2/css/all.min.css">

  <!-- 3rd-party Dependencies -->

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.27.20/dist/tocbot.min.css">
  

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css">
  

  
    <!-- Image Popup -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/glightbox@3.3.0/dist/css/glightbox.min.css">
  

  <!-- JavaScript -->

  
    <!-- Switch the mode between dark and light. -->

<script type="text/javascript">
  class ModeToggle {
    static get MODE_KEY() {
      return 'mode';
    }
    static get MODE_ATTR() {
      return 'data-mode';
    }
    static get DARK_MODE() {
      return 'dark';
    }
    static get LIGHT_MODE() {
      return 'light';
    }
    static get ID() {
      return 'mode-toggle';
    }

    constructor() {
      let self = this;this.sysDarkPrefers.addEventListener('change', () => {
        if (self.hasMode) {
          self.clearMode();
        }
        self.notify();
      });

      if (!this.hasMode) {
        return;
      }

      if (this.isDarkMode) {
        this.setDark();
      } else {
        this.setLight();
      }
    }

    get sysDarkPrefers() {
      return window.matchMedia('(prefers-color-scheme: dark)');
    }

    get isPreferDark() {
      return this.sysDarkPrefers.matches;
    }

    get isDarkMode() {
      return this.mode === ModeToggle.DARK_MODE;
    }

    get hasMode() {
      return this.mode != null;
    }

    get mode() {
      return sessionStorage.getItem(ModeToggle.MODE_KEY);
    }get modeStatus() {
      if (this.hasMode) {
        return this.mode;
      } else {
        return this.isPreferDark ? ModeToggle.DARK_MODE : ModeToggle.LIGHT_MODE;
      }
    }

    setDark() {
      document.documentElement.setAttribute(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE);
      sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE);
    }

    setLight() {
      document.documentElement.setAttribute(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE);
      sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE);
    }

    clearMode() {
      document.documentElement.removeAttribute(ModeToggle.MODE_ATTR);
      sessionStorage.removeItem(ModeToggle.MODE_KEY);
    }notify() {
      window.postMessage(
        {
          direction: ModeToggle.ID,
          message: this.modeStatus
        },
        '*'
      );
    }

    flipMode() {
      if (this.hasMode) {
        this.clearMode();
      } else {
        if (this.isPreferDark) {
          this.setLight();
        } else {
          this.setDark();
        }
      }

      this.notify();
    }
  }

  const modeToggle = new ModeToggle();
</script>

  

  <!-- A placeholder to allow defining custom metadata -->

</head>


  <body>
    <!-- The Side Bar -->

<aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end">
  <header class="profile-wrapper">
    <a href="/" id="avatar" class="rounded-circle"></a>

    <h1 class="site-title">
      <a href="/">Utsab Adhikari</a>
    </h1>
    <p class="site-subtitle fst-italic mb-0">A Site for my blog posts.</p>
  </header>
  <!-- .profile-wrapper -->

  <nav class="flex-column flex-grow-1 w-100 ps-0">
    <ul class="nav">
      <!-- home -->
      <li class="nav-item">
        <a href="/" class="nav-link">
          <i class="fa-fw fas fa-home"></i>
          <span>HOME</span>
        </a>
      </li>
      <!-- the real tabs -->
      
        <li class="nav-item">
          <a href="/categories/" class="nav-link">
            <i class="fa-fw fas fa-stream"></i>
            

            <span>CATEGORIES</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/tags/" class="nav-link">
            <i class="fa-fw fas fa-tags"></i>
            

            <span>TAGS</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/archives/" class="nav-link">
            <i class="fa-fw fas fa-archive"></i>
            

            <span>ARCHIVES</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/about/" class="nav-link">
            <i class="fa-fw fas fa-info-circle"></i>
            

            <span>ABOUT</span>
          </a>
        </li>
        <!-- .nav-item -->
      
    </ul>
  </nav>

  <div class="sidebar-bottom d-flex flex-wrap  align-items-center w-100">
    
      <button type="button" class="btn btn-link nav-link" aria-label="Switch Mode" id="mode-toggle">
        <i class="fas fa-adjust"></i>
      </button>

      
        <span class="icon-border"></span>
      
    

    
      

      
        <a
          href="https://github.com/FOLDSAB"
          aria-label="github"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fab fa-github"></i>
        </a>
      
    
      

      
        <a
          href="https://twitter.com/twitter_username"
          aria-label="twitter"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fa-brands fa-x-twitter"></i>
        </a>
      
    
      

      
        <a
          href="javascript:location.href = 'mailto:' + ['adhikariutshav999','hotmail.com'].join('@')"
          aria-label="email"
          

          

          

          
        >
          <i class="fas fa-envelope"></i>
        </a>
      
    
      

      
        <a
          href="/feed.xml"
          aria-label="rss"
          

          

          

          
        >
          <i class="fas fa-rss"></i>
        </a>
      
    
  </div>
  <!-- .sidebar-bottom -->
</aside>
<!-- #sidebar -->


    <div id="main-wrapper" class="d-flex justify-content-center">
      <div class="container d-flex flex-column px-xxl-5">
        <!-- The Top Bar -->

<header id="topbar-wrapper" aria-label="Top Bar">
  <div
    id="topbar"
    class="d-flex align-items-center justify-content-between px-lg-3 h-100"
  >
    <nav id="breadcrumb" aria-label="Breadcrumb">
      

      
        
          
            <span>
              <a href="/">Home</a>
            </span>

          
        
          
        
          
            
              <span>Command Line Spoofing</span>
            

          
        
      
    </nav>
    <!-- endof #breadcrumb -->

    <button type="button" id="sidebar-trigger" class="btn btn-link">
      <i class="fas fa-bars fa-fw"></i>
    </button>

    <div id="topbar-title">
      Post
    </div>

    <button type="button" id="search-trigger" class="btn btn-link">
      <i class="fas fa-search fa-fw"></i>
    </button>

    <search id="search" class="align-items-center ms-3 ms-lg-0">
      <i class="fas fa-search fa-fw"></i>
      <input
        class="form-control"
        id="search-input"
        type="search"
        aria-label="search"
        autocomplete="off"
        placeholder="Search..."
      >
    </search>
    <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button>
  </div>
</header>


        <div class="row flex-grow-1">
          <main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4">
            
              <!-- Refactor the HTML structure -->



<!--
  In order to allow a wide table to scroll horizontally,
  we suround the markdown table with `<div class="table-wrapper">` and `</div>`
-->



<!--
  Fixed kramdown code highlight rendering:
  https://github.com/penibelst/jekyll-compress-html/issues/101
  https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901
-->



<!-- Change the icon of checkbox -->



<!-- Handle images -->




  
  

  
    
      
      
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  

  


<!-- Add header for code snippets -->



<!-- Create heading anchors -->





  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    

    
  

  
  

  

  
  

  

  
  

  




<!-- return -->




<article class="px-1">
  <header>
    <h1 data-toc-skip>Command Line Spoofing</h1>
    

    <div class="post-meta text-muted">
      <!-- published date -->
      <span>
        Posted
        <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1722332940"
  data-df="ll"
  
    data-bs-toggle="tooltip" data-bs-placement="bottom"
  
>
  Jul 30, 2024
</time>

      </span>

      <!-- lastmod date -->
      
        <span>
          Updated
          <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1723319194"
  data-df="ll"
  
    data-bs-toggle="tooltip" data-bs-placement="bottom"
  
>
  Aug 11, 2024
</time>

        </span>
      

      

      <div class="d-flex justify-content-between">
        <!-- author(s) -->
        <span>
          

          By

          <em>
            
              <a href="https://twitter.com/username">Utsab Adhikari</a>
            
          </em>
        </span>

        <div>
          <!-- pageviews -->
          

          <!-- read time -->
          <!-- Calculate the post's reading time, and display the word count in tooltip -->



<!-- words per minute -->










<!-- return element -->
<span
  class="readtime"
  data-bs-toggle="tooltip"
  data-bs-placement="bottom"
  title="1203 words"
>
  <em>6 min</em> read</span>

        </div>
      </div>
    </div>
  </header>

  <div class="content">
    <p>Command line spoofing is a technique where the instructions given to a program through the command line are altered or replaced. To make this clearer, let’s break it down:</p>

<p>When a program runs, it often needs specific details or instructions to work correctly. These instructions are provided through the command line a way to type in commands and arguments that the operating system uses to run the program. For example, you might use command line arguments to tell a program which files to open or what actions to perform.</p>

<p>As can be seen in the screenshot below, the command line interface displays these arguments.</p>

<p><a href="/assets/img/command_line_spoofing/commandline_demonstration.png" class="popup img-link  shimmer"><img src="/assets/img/command_line_spoofing/commandline_demonstration.png" alt="commandline_demonstration" loading="lazy"></a></p>

<p>Command line spoofing happens when these instructions are changed or manipulated, leading the program to perform actions it wasn’t originally intended to. This can cause the program to behave differently or produce unexpected results.</p>

<h2 id="before-starting"><span class="me-2">Before Starting</span><a href="#before-starting" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>To change the command line of a process, we first need to know about Process Environment Block (PEB).</p>

<p>The Process Environment Block (PEB) is a data structure that holds important information about a process. It includes details such as:</p>

<ul>
  <li>Whether the program is being debugged</li>
  <li>Loaded modules</li>
  <li>Process parameters, and more</li>
</ul>

<p>Since the PEB is located in user space, it can be accessed relatively easily. The structure of the PEB looks like this:</p>

<div class="language-c highlighter-rouge"><div class="code-header">
        <span data-label-text="C"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre></td><td class="rouge-code"><pre><span class="k">typedef</span> <span class="k">struct</span> <span class="n">_PEB</span> <span class="p">{</span>
  <span class="n">BYTE</span>                          <span class="n">Reserved1</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
  <span class="n">BYTE</span>                          <span class="n">BeingDebugged</span><span class="p">;</span>
  <span class="n">BYTE</span>                          <span class="n">Reserved2</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
  <span class="n">PVOID</span>                         <span class="n">Reserved3</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
  <span class="n">PPEB_LDR_DATA</span>                 <span class="n">Ldr</span><span class="p">;</span>
  <span class="n">PRTL_USER_PROCESS_PARAMETERS</span>  <span class="n">ProcessParameters</span><span class="p">;</span>
  <span class="n">PVOID</span>                         <span class="n">Reserved4</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
  <span class="n">PVOID</span>                         <span class="n">AtlThunkSListPtr</span><span class="p">;</span>
  <span class="n">PVOID</span>                         <span class="n">Reserved5</span><span class="p">;</span>
  <span class="n">ULONG</span>                         <span class="n">Reserved6</span><span class="p">;</span>
  <span class="n">PVOID</span>                         <span class="n">Reserved7</span><span class="p">;</span>
  <span class="n">ULONG</span>                         <span class="n">Reserved8</span><span class="p">;</span>
  <span class="n">ULONG</span>                         <span class="n">AtlThunkSListPtr32</span><span class="p">;</span>
  <span class="n">PVOID</span>                         <span class="n">Reserved9</span><span class="p">[</span><span class="mi">45</span><span class="p">];</span>
  <span class="n">BYTE</span>                          <span class="n">Reserved10</span><span class="p">[</span><span class="mi">96</span><span class="p">];</span>
  <span class="n">PPS_POST_PROCESS_INIT_ROUTINE</span> <span class="n">PostProcessInitRoutine</span><span class="p">;</span>
  <span class="n">BYTE</span>                          <span class="n">Reserved11</span><span class="p">[</span><span class="mi">128</span><span class="p">];</span>
  <span class="n">PVOID</span>                         <span class="n">Reserved12</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
  <span class="n">ULONG</span>                         <span class="n">SessionId</span><span class="p">;</span>
<span class="p">}</span> <span class="n">PEB</span><span class="p">,</span> <span class="o">*</span><span class="n">PPEB</span><span class="p">;</span>

</pre></td></tr></tbody></table></code></div></div>

<p>In the <code class="language-plaintext highlighter-rouge">PEB</code> structure, the <code class="language-plaintext highlighter-rouge">ProcessParameters</code> field refers to the <code class="language-plaintext highlighter-rouge">PRTL_USER_PROCESS_PARAMETERS</code> structure which is our main focus because it contains the command line information of the process. To understand why this is important for spoofing the command line, let’s take a look at the structure:</p>

<div class="language-c highlighter-rouge"><div class="code-header">
        <span data-label-text="C"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre>
<span class="k">typedef</span> <span class="k">struct</span> <span class="n">_RTL_USER_PROCESS_PARAMETERS</span> <span class="p">{</span>
  <span class="n">BYTE</span>           <span class="n">Reserved1</span><span class="p">[</span><span class="mi">16</span><span class="p">];</span>
  <span class="n">PVOID</span>          <span class="n">Reserved2</span><span class="p">[</span><span class="mi">10</span><span class="p">];</span>
  <span class="n">UNICODE_STRING</span> <span class="n">ImagePathName</span><span class="p">;</span>
  <span class="n">UNICODE_STRING</span> <span class="n">CommandLine</span><span class="p">;</span>
<span class="p">}</span> <span class="n">RTL_USER_PROCESS_PARAMETERS</span><span class="p">,</span> <span class="o">*</span><span class="n">PRTL_USER_PROCESS_PARAMETERS</span><span class="p">;</span>

</pre></td></tr></tbody></table></code></div></div>

<p>The <code class="language-plaintext highlighter-rouge">PRTL_USER_PROCESS_PARAMETERS</code> structure includes a <code class="language-plaintext highlighter-rouge">CommandLine</code> field, which is a <code class="language-plaintext highlighter-rouge">UNICODE_STRING</code> structure. This field contains the actual command line arguments used by the process. To understand how to modify the command line, we need to take a closer look at the <code class="language-plaintext highlighter-rouge">UNICODE_STRING</code> structure.</p>

<div class="language-c highlighter-rouge"><div class="code-header">
        <span data-label-text="C"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre><span class="k">typedef</span> <span class="k">struct</span> <span class="n">_UNICODE_STRING</span> <span class="p">{</span>
  <span class="n">USHORT</span> <span class="n">Length</span><span class="p">;</span>
  <span class="n">USHORT</span> <span class="n">MaximumLength</span><span class="p">;</span>
  <span class="n">PWSTR</span>  <span class="n">Buffer</span><span class="p">;</span>
<span class="p">}</span> <span class="n">UNICODE_STRING</span><span class="p">,</span> <span class="o">*</span><span class="n">PUNICODE_STRING</span><span class="p">;</span>
</pre></td></tr></tbody></table></code></div></div>

<p>The <code class="language-plaintext highlighter-rouge">UNICODE_STRING</code> structure includes a <code class="language-plaintext highlighter-rouge">Buffer</code> field, which points to the actual command line arguments for the process. This <code class="language-plaintext highlighter-rouge">Buffer</code> contains the location where the command line string is stored.</p>

<p>If we can overwrite the data at the location pointed to by the <code class="language-plaintext highlighter-rouge">Buffer</code>, we should be able to change the command line arguments of the process.</p>

<h2 id="technique"><span class="me-2">Technique</span><a href="#technique" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>To change the command line of a process, we first need to find the address of the <code class="language-plaintext highlighter-rouge">PEB</code> (Process Environment Block). Here’s how we can do it:</p>

<ol>
  <li><strong>Retrieve the <code class="language-plaintext highlighter-rouge">PEB</code> Address</strong>:
    <ul>
      <li>Use the <a href="https://learn.microsoft.com/en-us/windows/win32/api/winternl/nf-winternl-ntqueryinformationprocess"><code class="language-plaintext highlighter-rouge">NtQueryInformationProcess</code></a> function with the <code class="language-plaintext highlighter-rouge">ProcessBasicInformation</code> value for the <code class="language-plaintext highlighter-rouge">ProcessInformationClass</code> parameter. This function provides a <code class="language-plaintext highlighter-rouge">PROCESS_BASIC_INFORMATION</code> structure.</li>
      <li>The <code class="language-plaintext highlighter-rouge">PROCESS_BASIC_INFORMATION</code> structure contains the address of the <code class="language-plaintext highlighter-rouge">PEB</code>.</li>
    </ul>
  </li>
  <li><strong>Access the <code class="language-plaintext highlighter-rouge">PEB</code> Structure</strong>:
    <ul>
      <li>Once we have the <code class="language-plaintext highlighter-rouge">PEB</code> address from the <code class="language-plaintext highlighter-rouge">PROCESS_BASIC_INFORMATION</code> structure, we need to read the process’s memory to access the <code class="language-plaintext highlighter-rouge">PEB</code> structure itself.</li>
    </ul>
  </li>
</ol>

<p>We will use a custom function called <code class="language-plaintext highlighter-rouge">ReadMemoryFromRemoteProcess</code> to retrieve the <code class="language-plaintext highlighter-rouge">PEB</code> structure from the process’s memory. This function internally uses the WINAPI function <a href="https://learn.microsoft.com/en-us/windows/win32/api/memoryapi/nf-memoryapi-readprocessmemory"><code class="language-plaintext highlighter-rouge">ReadProcessMemory</code></a>, which is used to read data from a specified memory location in a different process.</p>

<div class="language-c highlighter-rouge"><div class="code-header">
        <span data-label-text="C"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre></td><td class="rouge-code"><pre>
<span class="n">BOOL</span> <span class="nf">ReadMemoryFromRemoteProcess</span><span class="p">(</span><span class="n">HANDLE</span> <span class="n">hprocess</span><span class="p">,</span> <span class="n">LPVOID</span> <span class="n">lpbaseaddress</span><span class="p">,</span> <span class="n">LPVOID</span><span class="o">*</span> <span class="n">lpbuffer</span><span class="p">,</span> <span class="n">SIZE_T</span> <span class="n">szsize</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">SIZE_T</span> <span class="n">numberofbytesread</span><span class="p">;</span>

	<span class="o">*</span><span class="n">lpbuffer</span> <span class="o">=</span> <span class="n">HeapAlloc</span><span class="p">(</span><span class="n">GetProcessHeap</span><span class="p">(),</span> <span class="n">HEAP_ZERO_MEMORY</span><span class="p">,</span> <span class="n">szsize</span><span class="p">);</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">lpbuffer</span> <span class="o">==</span> <span class="nb">NULL</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">printf</span><span class="p">(</span><span class="s">"Heap allocation failed with error no %x</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">GetLastError</span><span class="p">());</span>
	<span class="p">}</span>

	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">ReadProcessMemory</span><span class="p">(</span><span class="n">hprocess</span><span class="p">,</span> <span class="n">lpbaseaddress</span><span class="p">,</span> <span class="o">*</span><span class="n">lpbuffer</span><span class="p">,</span> <span class="n">szsize</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">numberofbytesread</span><span class="p">)</span> <span class="o">||</span> <span class="n">szsize</span> <span class="o">!=</span> <span class="n">numberofbytesread</span><span class="p">)</span> <span class="p">{</span>


		<span class="n">printf</span><span class="p">(</span><span class="s">"readprocess memroy failed with error no %x</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">GetLastError</span><span class="p">());</span>
		<span class="k">return</span> <span class="n">FALSE</span><span class="p">;</span>
	<span class="p">}</span>


	<span class="k">return</span> <span class="n">TRUE</span><span class="p">;</span>
<span class="p">}</span>

</pre></td></tr></tbody></table></code></div></div>

<p>After accessing the <code class="language-plaintext highlighter-rouge">PEB</code> structure, we will locate and modify the <code class="language-plaintext highlighter-rouge">CommandLine</code> field. To do this, we use a custom function named <code class="language-plaintext highlighter-rouge">WriteMemoryToRemoteProcess</code>. This function utilizes the <code class="language-plaintext highlighter-rouge">WriteProcessMemory</code> WinAPI function to write the new command line data into the target process’s memory space.</p>

<div class="language-c highlighter-rouge"><div class="code-header">
        <span data-label-text="C"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre></td><td class="rouge-code"><pre>
<span class="n">BOOL</span> <span class="nf">WriteMemoryToRemoteProcess</span><span class="p">(</span><span class="n">HANDLE</span> <span class="n">hprocess</span><span class="p">,</span> <span class="n">LPVOID</span> <span class="n">lpbaseaddress</span><span class="p">,</span> <span class="n">LPVOID</span> <span class="n">lpbuffer</span><span class="p">,</span> <span class="n">SIZE_T</span> <span class="n">szsize</span><span class="p">)</span> 
<span class="p">{</span>

	<span class="n">SIZE_T</span> <span class="n">lpNumberOfBytesWritten</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">WriteProcessMemory</span><span class="p">(</span><span class="n">hprocess</span><span class="p">,</span> <span class="n">lpbaseaddress</span><span class="p">,</span> <span class="n">lpbuffer</span><span class="p">,</span> <span class="n">szsize</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">lpNumberOfBytesWritten</span><span class="p">)</span> <span class="o">||</span> <span class="n">szsize</span> <span class="o">!=</span> <span class="n">lpNumberOfBytesWritten</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">printf</span><span class="p">(</span><span class="s">"write process memory failed with error no %x</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">GetLastError</span><span class="p">());</span>

		<span class="k">return</span> <span class="n">FALSE</span><span class="p">;</span>
	<span class="p">}</span>
<span class="k">return</span> <span class="n">TRUE</span><span class="p">;</span>


<span class="p">}</span>
</pre></td></tr></tbody></table></code></div></div>

<h2 id="logic"><span class="me-2">Logic</span><a href="#logic" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>
<ol>
  <li>Either create a new process or obtain a handle to an existing process where the command line needs to be modified.</li>
  <li>Access the buffer in the target process’s memory where the current command line is stored.</li>
  <li>Prepare the new command line string that you want to write into the process’s memory.</li>
  <li>Use the <code class="language-plaintext highlighter-rouge">WriteProcessMemory</code> function to write the new command line data to the appropriate memory address in the target process.</li>
</ol>

<h2 id="commandlinespoofing-function"><span class="me-2">Commandlinespoofing function</span><a href="#commandlinespoofing-function" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>
<p><code class="language-plaintext highlighter-rouge">Commandlinespoofing</code> is a function that implements above technique and logics to spoof the commandline of a process.  in this case notepad is created for simplicity in demonstration.</p>

<div class="language-c highlighter-rouge"><div class="code-header">
        <span data-label-text="C"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
</pre></td><td class="rouge-code"><pre><span class="n">BOOL</span> <span class="nf">Commandlinespoofing</span><span class="p">()</span> <span class="p">{</span>


	<span class="k">typedef</span> <span class="n">NTSTATUS</span><span class="p">(</span><span class="n">NTAPI</span><span class="o">*</span> <span class="n">fnNtQueryInformationProcess</span><span class="p">)(</span>
		<span class="n">HANDLE</span> <span class="n">ProcessHandle</span><span class="p">,</span>
		<span class="n">PROCESSINFOCLASS</span> <span class="n">ProcessInformationClass</span><span class="p">,</span>
		<span class="n">PVOID</span> <span class="n">ProcessInformation</span><span class="p">,</span>
		<span class="n">ULONG</span> <span class="n">ProcessInformationLength</span><span class="p">,</span>
		<span class="n">PULONG</span> <span class="n">ReturnLength</span>
		<span class="p">);</span>

<span class="c1">// first command</span>
	<span class="n">WCHAR</span> <span class="n">commandline</span><span class="p">[]</span> <span class="o">=</span> <span class="s">L"notepad first command "</span><span class="p">;</span>

	<span class="n">STARTUPINFOW</span> <span class="n">SI</span> <span class="o">=</span> <span class="p">{</span> <span class="mi">0</span> <span class="p">};</span>
	<span class="n">SI</span><span class="p">.</span><span class="n">cb</span> <span class="o">=</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">SI</span><span class="p">);</span>
	<span class="n">PRTL_USER_PROCESS_PARAMETERS</span> <span class="n">pprocessparams</span><span class="p">;</span>
	<span class="n">PROCESS_INFORMATION</span> <span class="n">PI</span> <span class="o">=</span> <span class="p">{</span> <span class="mi">0</span> <span class="p">};</span>

	<span class="n">NTSTATUS</span> <span class="n">status</span><span class="p">;</span>

	<span class="n">PROCESS_BASIC_INFORMATION</span> <span class="n">PBI</span> <span class="o">=</span> <span class="p">{</span> <span class="mi">0</span> <span class="p">};</span>

	<span class="n">PPEB</span> <span class="n">ppeb</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>




	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">CreateProcessW</span><span class="p">(</span><span class="nb">NULL</span><span class="p">,</span> <span class="n">commandline</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="n">FALSE</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">SI</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">PI</span><span class="p">))</span> <span class="p">{</span>

		<span class="n">printf</span><span class="p">(</span><span class="s">"Create process failed with error no %x</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">GetLastError</span><span class="p">());</span>
		<span class="k">return</span> <span class="n">FALSE</span><span class="p">;</span>
	<span class="p">}</span>
<span class="c1">// getting address of NtQueryInformationProcess</span>
	<span class="n">fnNtQueryInformationProcess</span> <span class="n">NTinformationprocess</span> <span class="o">=</span> <span class="n">GetProcAddress</span><span class="p">(</span><span class="n">GetModuleHandleW</span><span class="p">(</span><span class="s">L"ntdll.dll"</span><span class="p">),</span> <span class="s">"NtQueryInformationProcess"</span><span class="p">);</span>


	<span class="k">if</span> <span class="p">(</span><span class="n">NTinformationprocess</span> <span class="o">==</span> <span class="nb">NULL</span><span class="p">)</span> <span class="p">{</span>

		<span class="n">printf</span><span class="p">(</span><span class="s">"GetprocAddress or GetmoduleHandleW failed with error no %x</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">GetLastError</span><span class="p">());</span>
		<span class="k">return</span> <span class="n">FALSE</span><span class="p">;</span>

	<span class="p">}</span>

	<span class="n">ULONG</span> <span class="n">returnlength</span><span class="p">;</span>


	<span class="n">status</span> <span class="o">=</span> <span class="n">NTinformationprocess</span><span class="p">(</span><span class="n">PI</span><span class="p">.</span><span class="n">hProcess</span><span class="p">,</span> <span class="n">ProcessBasicInformation</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">PBI</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">PBI</span><span class="p">),</span> <span class="o">&amp;</span><span class="n">returnlength</span><span class="p">);</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">status</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>

		<span class="n">printf</span><span class="p">(</span><span class="s">"ntinformation process failed with error no %x</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">GetLastError</span><span class="p">());</span>

	<span class="p">}</span>
<span class="c1">// ReadMemoryFromRemoteProcess function mentioned above</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">ReadMemoryFromRemoteProcess</span><span class="p">(</span><span class="n">PI</span><span class="p">.</span><span class="n">hProcess</span><span class="p">,</span> <span class="n">PBI</span><span class="p">.</span><span class="n">PebBaseAddress</span><span class="p">,</span><span class="o">&amp;</span><span class="n">ppeb</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">PEB</span><span class="p">)))</span> <span class="p">{</span>
		<span class="k">return</span> <span class="n">FALSE</span><span class="p">;</span>
	<span class="p">}</span>


<span class="c1">//sizeof(RTL_USER_PROCESS_PARAMETERS) + 0xFF , 0xFF is added so we can reach to the command line </span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">ReadMemoryFromRemoteProcess</span><span class="p">(</span><span class="n">PI</span><span class="p">.</span><span class="n">hProcess</span><span class="p">,</span> <span class="n">ppeb</span><span class="o">-&gt;</span><span class="n">ProcessParameters</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">pprocessparams</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">RTL_USER_PROCESS_PARAMETERS</span><span class="p">)</span> <span class="o">+</span> <span class="mh">0xFF</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">HeapFree</span><span class="p">(</span><span class="n">GetProcessHeap</span><span class="p">(),</span> <span class="mi">0</span><span class="p">,</span> <span class="n">pprocessparams</span><span class="p">);</span>
		<span class="k">return</span> <span class="n">FALSE</span><span class="p">;</span>
	<span class="p">}</span>

<span class="c1">//new commandline</span>
	<span class="n">WCHAR</span> <span class="n">updatecommandline</span><span class="p">[]</span> <span class="o">=</span> <span class="s">L"updated command line"</span><span class="p">;</span>

<span class="c1">// WriteMemoryToRemoteProcess function mentioned above</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">WriteMemoryToRemoteProcess</span><span class="p">(</span><span class="n">PI</span><span class="p">.</span><span class="n">hProcess</span><span class="p">,</span> <span class="n">pprocessparams</span><span class="o">-&gt;</span><span class="n">CommandLine</span><span class="p">.</span><span class="n">Buffer</span><span class="p">,</span> <span class="n">updatecommandline</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">updatecommandline</span><span class="p">)))</span> <span class="p">{</span>
		<span class="k">return</span> <span class="n">FALSE</span><span class="p">;</span>
	<span class="p">}</span>

<span class="p">}</span>


</pre></td></tr></tbody></table></code></div></div>

<h2 id="execution"><span class="me-2">Execution</span><a href="#execution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>For simplicity, we use <code class="language-plaintext highlighter-rouge">Notepad</code> for the execution process.</p>

<p><code class="language-plaintext highlighter-rouge">Notepad</code> is started with “notepad first command” command line then it has been spoofed to “updated command line”.</p>

<p><a href="/assets/img/command_line_spoofing/noteapad_first_command.png" class="popup img-link  shimmer"><img src="/assets/img/command_line_spoofing/noteapad_first_command.png" alt="commandline_spoofing" loading="lazy"></a></p>

<p><strong>NOTE:</strong> Command line spoofing does not work with <code class="language-plaintext highlighter-rouge">calc.exe</code> in my case for demonstration. This might be because <code class="language-plaintext highlighter-rouge">calc.exe</code> falls under the <a href="https://www.bing.com/ck/a?!&amp;&amp;p=189f3e1367c572cbJmltdHM9MTcyMjI5NzYwMCZpZ3VpZD0yMDhhZmQxMi1hYWY0LTYyODMtMDM4ZC1lOWRlYWI3ZDYzNTImaW5zaWQ9NTQzNw&amp;ptn=3&amp;ver=2&amp;hsh=3&amp;fclid=208afd12-aaf4-6283-038d-e9deab7d6352&amp;psq=uwp+&amp;u=a1aHR0cHM6Ly9sZWFybi5taWNyb3NvZnQuY29tL2VuLXVzL3dpbmRvd3MvdXdwL2dldC1zdGFydGVkL3VuaXZlcnNhbC1hcHBsaWNhdGlvbi1wbGF0Zm9ybS1ndWlkZQ&amp;ntb=1">Universal Windows Platform (UWP)</a>, which may not support traditional command line spoofing techniques.</p>


  </div>

  <div class="post-tail-wrapper text-muted">
    <!-- categories -->
    
      <div class="post-meta mb-3">
        <i class="far fa-folder-open fa-fw me-1"></i>
        
          <a href="/categories/malware-development/">Malware Development</a>
      </div>
    

    <!-- tags -->
    
      <div class="post-tags">
        <i class="fa fa-tags fa-fw me-1"></i>
        
          <a
            href="/tags/malware-development/"
            class="post-tag no-text-decoration"
          >Malware Development</a>
        
      </div>
    

    <div
      class="
        post-tail-bottom
        d-flex justify-content-between align-items-center mt-5 pb-2
      "
    >
      <div class="license-wrapper">
        
          

          This post is licensed under 
        <a href="https://creativecommons.org/licenses/by/4.0/">
          CC BY 4.0
        </a>
         by the author.
        
      </div>

      <!-- Post sharing snippet -->

<div class="share-wrapper d-flex align-items-center">
  <span class="share-label text-muted">Share</span>
  <span class="share-icons">
    
    
    

    

      

      <a href="https://twitter.com/intent/tweet?text=Command%20Line%20Spoofing%20-%20Utsab%20Adhikari&url=http%3A%2F%2Flocalhost%3A4000%2Fposts%2Fcommand-line-spoofing%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" aria-label="Twitter">
        <i class="fa-fw fa-brands fa-square-x-twitter"></i>
      </a>
    

      

      <a href="https://www.facebook.com/sharer/sharer.php?title=Command%20Line%20Spoofing%20-%20Utsab%20Adhikari&u=http%3A%2F%2Flocalhost%3A4000%2Fposts%2Fcommand-line-spoofing%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" aria-label="Facebook">
        <i class="fa-fw fab fa-facebook-square"></i>
      </a>
    

      

      <a href="https://t.me/share/url?url=http%3A%2F%2Flocalhost%3A4000%2Fposts%2Fcommand-line-spoofing%2F&text=Command%20Line%20Spoofing%20-%20Utsab%20Adhikari" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Telegram" aria-label="Telegram">
        <i class="fa-fw fab fa-telegram"></i>
      </a>
    

    <button
      id="copy-link"
      aria-label="Copy link"
      class="btn small"
      data-bs-toggle="tooltip"
      data-bs-placement="top"
      title="Copy link"
      data-title-succeed="Link copied successfully!"
    >
      <i class="fa-fw fas fa-link pe-none fs-6"></i>
    </button>
  </span>
</div>

    </div>
    <!-- .post-tail-bottom -->
  </div>
  <!-- div.post-tail-wrapper -->
</article>


            
          </main>

          <!-- panel -->
          <aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 mb-5 text-muted">
            <div class="access">
              <!-- Get 5 last posted/updated posts -->














  <section id="access-lastmod">
    <h2 class="panel-heading">Recently Updated</h2>
    <ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2">
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/Analaysis_of_Macro-Embeeded-Excel-File/">Analysis of Macro-Embedded Excel File</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/UAC_bypass_using_fodhelper/">UAC bypass using fodhelper</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/command-line-spoofing/">Command Line Spoofing</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/Windows_core_processes/">Windows Core Processes</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/local_function_stomping_injection/">Local Function Stomping Injection</a>
        </li>
      
    </ul>
  </section>
  <!-- #access-lastmod -->


              <!-- The trending tags list -->















  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
        
        



  <section>
    <h2 class="panel-heading">Trending Tags</h2>
    <div class="d-flex flex-wrap mt-3 mb-1 me-3">
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/malware-development/">Malware Development</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/windows-internals/">Windows Internals</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/malware-analysis/">Malware Analysis</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/uac-bypass/">UAC Bypass</a>
      
    </div>
  </section>


            </div>

            
              
              



  <section id="toc-wrapper" class="d-none ps-0 pe-4">
    <h2 class="panel-heading ps-3 mb-2">Contents</h2>
    <nav id="toc"></nav>
  </section>


            
          </aside>
        </div>

        <div class="row">
          <!-- tail -->
          <div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4">
            
              
              <!-- Recommend the other 3 posts according to the tags and categories of the current post. -->

<!-- The total size of related posts -->


<!-- An random integer that bigger than 0 -->


<!-- Equals to TAG_SCORE / {max_categories_hierarchy} -->















  

  

  

  

  

  

  

  

  

  

  

  

  

  
    
  

  

  

  

  

  











  <aside id="related-posts" aria-labelledby="related-label">
    <h3 class="mb-4" id="related-label">Further Reading</h3>
    <nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4">
      
        <article class="col">
          <a href="/posts/UAC_bypass_using_fodhelper/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1724233740"
  data-df="ll"
  
>
  Aug 21, 2024
</time>

              <h4 class="pt-0 my-2">UAC bypass using fodhelper</h4>
              <div class="text-muted">
                <p>User Account Control (UAC) is a crucial security feature in Windows designed to prevent unauthorized changes to the operating system. However, vulnerabilities in UAC can be exploited to escalate pr...</p>
              </div>
            </div>
          </a>
        </article>
      
        <article class="col">
          <a href="/posts/local_function_stomping_injection/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1722260820"
  data-df="ll"
  
>
  Jul 29, 2024
</time>

              <h4 class="pt-0 my-2">Local Function Stomping Injection</h4>
              <div class="text-muted">
                <p>Function Stomping

Function stomping typically refers to overwriting the code or data of a function with different content in its memory space. This can be done to modify the behavior of the functi...</p>
              </div>
            </div>
          </a>
        </article>
      
        <article class="col">
          <a href="/posts/spoofing_parent_process_id/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1722246540"
  data-df="ll"
  
>
  Jul 29, 2024
</time>

              <h4 class="pt-0 my-2">Spoofing Parent Process ID (PPID)</h4>
              <div class="text-muted">
                <p>Parent Process ID (PPID) spoofing is a technique used to manipulate the relationship between a child process and its parent process. This makes it appear as though the child process was initiated b...</p>
              </div>
            </div>
          </a>
        </article>
      
    </nav>
  </aside>
  <!-- #related-posts -->


            
              
              <!-- Navigation buttons at the bottom of the post. -->

<nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation">
  
  

  
    <a
      href="/posts/local_function_stomping_injection/"
      class="btn btn-outline-primary"
      aria-label="Older"
    >
      <p>Local Function Stomping Injection</p>
    </a>
  

  
    <a
      href="/posts/Windows_core_processes/"
      class="btn btn-outline-primary"
      aria-label="Newer"
    >
      <p>Windows Core Processes</p>
    </a>
  
</nav>

            
              
              <!-- The comments switcher -->


            

            <!-- The Footer -->

<footer
  aria-label="Site Info"
  class="
    d-flex flex-column justify-content-center text-muted
    flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3
  "
>
  <p>©
    <time>2024</time>

    
      <a href="https://twitter.com/username">Utsab Adhikari</a>.
    

    
      <span
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author."
      >Some rights reserved.</span>
    
  </p>

  <p>Using the <a
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="v7.0.1"
        href="https://github.com/cotes2020/jekyll-theme-chirpy"
        target="_blank"
        rel="noopener"
      >Chirpy</a> theme for <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>.
  </p>
</footer>

          </div>
        </div>

        <!-- The Search results -->

<div id="search-result-wrapper" class="d-flex justify-content-center d-none">
  <div class="col-11 content">
    <div id="search-hints">
      <!-- The trending tags list -->















  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
        
        



  <section>
    <h2 class="panel-heading">Trending Tags</h2>
    <div class="d-flex flex-wrap mt-3 mb-1 me-3">
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/malware-development/">Malware Development</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/windows-internals/">Windows Internals</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/malware-analysis/">Malware Analysis</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/uac-bypass/">UAC Bypass</a>
      
    </div>
  </section>


    </div>
    <div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div>
  </div>
</div>

      </div>

      <aside aria-label="Scroll to Top">
        <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow">
          <i class="fas fa-angle-up"></i>
        </button>
      </aside>
    </div>

    <div id="mask"></div>

    
      <aside
  id="notification"
  class="toast"
  role="alert"
  aria-live="assertive"
  aria-atomic="true"
  data-bs-animation="true"
  data-bs-autohide="false"
>
  <div class="toast-header">
    <button
      type="button"
      class="btn-close ms-auto"
      data-bs-dismiss="toast"
      aria-label="Close"
    ></button>
  </div>
  <div class="toast-body text-center pt-0">
    <p class="px-2 mb-3">A new version of content is available.</p>
    <button type="button" class="btn btn-primary" aria-label="Update">
      Update
    </button>
  </div>
</aside>

    

    <!-- JavaScripts -->
    <!-- JS selector for site. -->

<!-- commons -->



<!-- layout specified -->




  

  
    <!-- image lazy-loading & popup & clipboard -->
    
  















  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  



  <script src="https://cdn.jsdelivr.net/combine/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/glightbox@3.3.0/dist/js/glightbox.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.11/dayjs.min.js,npm/dayjs@1.11.11/locale/en.min.js,npm/dayjs@1.11.11/plugin/relativeTime.min.js,npm/dayjs@1.11.11/plugin/localizedFormat.min.js,npm/tocbot@4.27.20/dist/tocbot.min.js"></script>






<script src="/assets/js/dist/post.min.js"></script>



<!-- Pageviews -->

  

  







    <!--
  Jekyll Simple Search loader
  See: <https://github.com/christian-fei/Simple-Jekyll-Search>
-->





<script>SimpleJekyllSearch({
    searchInput: document.getElementById('search-input'),
    resultsContainer: document.getElementById('search-results'),
    json: '/assets/js/data/search.json',
    searchResultTemplate: '  <article class="px-1 px-sm-2 px-lg-4 px-xl-0">    <header>      <h2><a href="{url}">{title}</a></h2>      <div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1">        {categories}        {tags}      </div>    </header>    <p>{snippet}</p>  </article>',
    noResultsText: '<p class="mt-5">Oops! No results found.</p>',
    templateMiddleware: function(prop, value, template) {
      if (prop === 'categories') {
        if (value === '') {
          return `${value}`;
        } else {
          return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`;
        }
      }

      if (prop === 'tags') {
        if (value === '') {
          return `${value}`;
        } else {
          return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`;
        }
      }
    }
  });
</script>

  </body>
</html>

