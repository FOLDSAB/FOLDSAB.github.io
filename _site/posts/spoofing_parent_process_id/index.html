<!doctype html>














<!-- `site.alt_lang` can specify a language different from the UI -->
<html lang="en" >
  <head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7">
  <meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta
    name="viewport"
    content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover"
  ><!-- Setup Open Graph image -->

  

  <!-- Begin Jekyll SEO tag v2.8.0 -->
<meta name="generator" content="Jekyll v4.3.3" />
<meta property="og:title" content="Spoofing Parent Process ID (PPID)" />
<meta property="og:locale" content="en" />
<meta name="description" content="A minimal, responsive and feature-rich Jekyll theme for technical writing." />
<meta property="og:description" content="A minimal, responsive and feature-rich Jekyll theme for technical writing." />
<link rel="canonical" href="http://localhost:4000/posts/spoofing_parent_process_id/" />
<meta property="og:url" content="http://localhost:4000/posts/spoofing_parent_process_id/" />
<meta property="og:site_name" content="Utsab Adhikari" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2024-07-29T15:34:00+05:45" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Spoofing Parent Process ID (PPID)" />
<meta name="twitter:site" content="@twitter_username" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2024-07-30T13:11:12+05:45","datePublished":"2024-07-29T15:34:00+05:45","description":"A minimal, responsive and feature-rich Jekyll theme for technical writing.","headline":"Spoofing Parent Process ID (PPID)","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/posts/spoofing_parent_process_id/"},"url":"http://localhost:4000/posts/spoofing_parent_process_id/"}</script>
<!-- End Jekyll SEO tag -->


  <title>Spoofing Parent Process ID (PPID) | Utsab Adhikari
  </title>

  <!--
  The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps
  Generated by: https://realfavicongenerator.net/
-->



<link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png">

  <link rel="manifest" href="/assets/img/favicons/site.webmanifest">

<link rel="shortcut icon" href="/assets/img/favicons/favicon.ico">
<meta name="apple-mobile-web-app-title" content="Utsab Adhikari">
<meta name="application-name" content="Utsab Adhikari">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml">
<meta name="theme-color" content="#ffffff">


  <!-- Resource Hints -->
  
    
      
        <link rel="preconnect" href="https://fonts.googleapis.com" >
      
        <link rel="dns-prefetch" href="https://fonts.googleapis.com" >
      
    
      
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
      
        <link rel="dns-prefetch" href="https://fonts.gstatic.com" >
      
    
      
        <link rel="preconnect" href="https://cdn.jsdelivr.net" >
      
        <link rel="dns-prefetch" href="https://cdn.jsdelivr.net" >
      
    
  

  <!-- Bootstrap -->
  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">
  

  <!-- Theme style -->
  <link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css">

  <!-- Web Font -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400&family=Source+Sans+Pro:wght@400;600;700;900&display=swap">

  <!-- Font Awesome Icons -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.2/css/all.min.css">

  <!-- 3rd-party Dependencies -->

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.27.20/dist/tocbot.min.css">
  

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css">
  

  
    <!-- Image Popup -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/glightbox@3.3.0/dist/css/glightbox.min.css">
  

  <!-- JavaScript -->

  
    <!-- Switch the mode between dark and light. -->

<script type="text/javascript">
  class ModeToggle {
    static get MODE_KEY() {
      return 'mode';
    }
    static get MODE_ATTR() {
      return 'data-mode';
    }
    static get DARK_MODE() {
      return 'dark';
    }
    static get LIGHT_MODE() {
      return 'light';
    }
    static get ID() {
      return 'mode-toggle';
    }

    constructor() {
      let self = this;this.sysDarkPrefers.addEventListener('change', () => {
        if (self.hasMode) {
          self.clearMode();
        }
        self.notify();
      });

      if (!this.hasMode) {
        return;
      }

      if (this.isDarkMode) {
        this.setDark();
      } else {
        this.setLight();
      }
    }

    get sysDarkPrefers() {
      return window.matchMedia('(prefers-color-scheme: dark)');
    }

    get isPreferDark() {
      return this.sysDarkPrefers.matches;
    }

    get isDarkMode() {
      return this.mode === ModeToggle.DARK_MODE;
    }

    get hasMode() {
      return this.mode != null;
    }

    get mode() {
      return sessionStorage.getItem(ModeToggle.MODE_KEY);
    }get modeStatus() {
      if (this.hasMode) {
        return this.mode;
      } else {
        return this.isPreferDark ? ModeToggle.DARK_MODE : ModeToggle.LIGHT_MODE;
      }
    }

    setDark() {
      document.documentElement.setAttribute(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE);
      sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE);
    }

    setLight() {
      document.documentElement.setAttribute(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE);
      sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE);
    }

    clearMode() {
      document.documentElement.removeAttribute(ModeToggle.MODE_ATTR);
      sessionStorage.removeItem(ModeToggle.MODE_KEY);
    }notify() {
      window.postMessage(
        {
          direction: ModeToggle.ID,
          message: this.modeStatus
        },
        '*'
      );
    }

    flipMode() {
      if (this.hasMode) {
        this.clearMode();
      } else {
        if (this.isPreferDark) {
          this.setLight();
        } else {
          this.setDark();
        }
      }

      this.notify();
    }
  }

  const modeToggle = new ModeToggle();
</script>

  

  <!-- A placeholder to allow defining custom metadata -->

</head>


  <body>
    <!-- The Side Bar -->

<aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end">
  <header class="profile-wrapper">
    <a href="/" id="avatar" class="rounded-circle"></a>

    <h1 class="site-title">
      <a href="/">Utsab Adhikari</a>
    </h1>
    <p class="site-subtitle fst-italic mb-0">A Site for my blog posts.</p>
  </header>
  <!-- .profile-wrapper -->

  <nav class="flex-column flex-grow-1 w-100 ps-0">
    <ul class="nav">
      <!-- home -->
      <li class="nav-item">
        <a href="/" class="nav-link">
          <i class="fa-fw fas fa-home"></i>
          <span>HOME</span>
        </a>
      </li>
      <!-- the real tabs -->
      
        <li class="nav-item">
          <a href="/categories/" class="nav-link">
            <i class="fa-fw fas fa-stream"></i>
            

            <span>CATEGORIES</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/tags/" class="nav-link">
            <i class="fa-fw fas fa-tags"></i>
            

            <span>TAGS</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/archives/" class="nav-link">
            <i class="fa-fw fas fa-archive"></i>
            

            <span>ARCHIVES</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/about/" class="nav-link">
            <i class="fa-fw fas fa-info-circle"></i>
            

            <span>ABOUT</span>
          </a>
        </li>
        <!-- .nav-item -->
      
    </ul>
  </nav>

  <div class="sidebar-bottom d-flex flex-wrap  align-items-center w-100">
    
      <button type="button" class="btn btn-link nav-link" aria-label="Switch Mode" id="mode-toggle">
        <i class="fas fa-adjust"></i>
      </button>

      
        <span class="icon-border"></span>
      
    

    
      

      
        <a
          href="https://github.com/FOLDSAB"
          aria-label="github"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fab fa-github"></i>
        </a>
      
    
      

      
        <a
          href="https://twitter.com/twitter_username"
          aria-label="twitter"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fa-brands fa-x-twitter"></i>
        </a>
      
    
      

      
        <a
          href="javascript:location.href = 'mailto:' + ['adhikariutshav999','hotmail.com'].join('@')"
          aria-label="email"
          

          

          

          
        >
          <i class="fas fa-envelope"></i>
        </a>
      
    
      

      
        <a
          href="/feed.xml"
          aria-label="rss"
          

          

          

          
        >
          <i class="fas fa-rss"></i>
        </a>
      
    
  </div>
  <!-- .sidebar-bottom -->
</aside>
<!-- #sidebar -->


    <div id="main-wrapper" class="d-flex justify-content-center">
      <div class="container d-flex flex-column px-xxl-5">
        <!-- The Top Bar -->

<header id="topbar-wrapper" aria-label="Top Bar">
  <div
    id="topbar"
    class="d-flex align-items-center justify-content-between px-lg-3 h-100"
  >
    <nav id="breadcrumb" aria-label="Breadcrumb">
      

      
        
          
            <span>
              <a href="/">Home</a>
            </span>

          
        
          
        
          
            
              <span>Spoofing Parent Process ID (PPID)</span>
            

          
        
      
    </nav>
    <!-- endof #breadcrumb -->

    <button type="button" id="sidebar-trigger" class="btn btn-link">
      <i class="fas fa-bars fa-fw"></i>
    </button>

    <div id="topbar-title">
      Post
    </div>

    <button type="button" id="search-trigger" class="btn btn-link">
      <i class="fas fa-search fa-fw"></i>
    </button>

    <search id="search" class="align-items-center ms-3 ms-lg-0">
      <i class="fas fa-search fa-fw"></i>
      <input
        class="form-control"
        id="search-input"
        type="search"
        aria-label="search"
        autocomplete="off"
        placeholder="Search..."
      >
    </search>
    <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button>
  </div>
</header>


        <div class="row flex-grow-1">
          <main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4">
            
              <!-- Refactor the HTML structure -->



<!--
  In order to allow a wide table to scroll horizontally,
  we suround the markdown table with `<div class="table-wrapper">` and `</div>`
-->



<!--
  Fixed kramdown code highlight rendering:
  https://github.com/penibelst/jekyll-compress-html/issues/101
  https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901
-->



<!-- Change the icon of checkbox -->



<!-- Handle images -->




  
  

  
    
      
      
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  

  


<!-- Add header for code snippets -->



<!-- Create heading anchors -->





  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    

    
  

  
  

  

  
  

  

  
  

  




<!-- return -->




<article class="px-1">
  <header>
    <h1 data-toc-skip>Spoofing Parent Process ID (PPID)</h1>
    

    <div class="post-meta text-muted">
      <!-- published date -->
      <span>
        Posted
        <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1722246540"
  data-df="ll"
  
    data-bs-toggle="tooltip" data-bs-placement="bottom"
  
>
  Jul 29, 2024
</time>

      </span>

      <!-- lastmod date -->
      
        <span>
          Updated
          <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1722324372"
  data-df="ll"
  
    data-bs-toggle="tooltip" data-bs-placement="bottom"
  
>
  Jul 30, 2024
</time>

        </span>
      

      

      <div class="d-flex justify-content-between">
        <!-- author(s) -->
        <span>
          

          By

          <em>
            
              <a href="https://twitter.com/username">Utsab Adhikari</a>
            
          </em>
        </span>

        <div>
          <!-- pageviews -->
          

          <!-- read time -->
          <!-- Calculate the post's reading time, and display the word count in tooltip -->



<!-- words per minute -->










<!-- return element -->
<span
  class="readtime"
  data-bs-toggle="tooltip"
  data-bs-placement="bottom"
  title="828 words"
>
  <em>4 min</em> read</span>

        </div>
      </div>
    </div>
  </header>

  <div class="content">
    <!-- # Spoofing Parent Process ID (PPID) -->

<p>Parent Process ID (PPID) spoofing is a technique used to manipulate the relationship between a child process and its parent process. This makes it appear as though the child process was initiated by a different, legitimate process.</p>

<p>This can be achieved by modifying the parent process ID, making it appear as though the process originated from a trusted source. For example, an Excel sheet spawning a `cmd.exe` process would typically raise suspicions with security solutions, but `svchost.exe` spawning a `cmd.exe` would not.</p>

<p>Let’s explore how to spoof the Parent Process ID (PPID) of a process.</p>

<h2 id="creating-a-process"><span class="me-2">Creating a process</span><a href="#creating-a-process" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>To spoof a process PPID, we first need to create a process using the <a href="https://learn.microsoft.com/en-us/windows/win32/api/processthreadsapi/nf-processthreadsapi-createprocessw">CreateProcess</a> WinAPI with the <code class="language-plaintext highlighter-rouge">EXTENDED_STARTUPINFO_PRESENT</code> flag set in the <code class="language-plaintext highlighter-rouge">dwCreationFlags</code> parameter. According to Microsoft documentation, this requires a <a href="https://learn.microsoft.com/en-us/windows/win32/api/winbase/ns-winbase-startupinfoexw">STARTUPINFOEX</a> structure in the <code class="language-plaintext highlighter-rouge">lpStartupInfo</code> parameter.</p>

<p><a href="/assets/img/2024-07-16-png_spoofing_parent_process/startupinfo_present.png" class="popup img-link  shimmer"><img src="/assets/img/2024-07-16-png_spoofing_parent_process/startupinfo_present.png" alt="Extended_startup" loading="lazy"></a></p>

<h2 id="startupinfoex-structure"><span class="me-2">STARTUPINFOEX structure</span><a href="#startupinfoex-structure" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>The <code class="language-plaintext highlighter-rouge">STARTUPINFOEX</code> structure specifies the window station, desktop, standard handles, and attributes for a new process. Since it is responsible for defining attributes for a new process, it will be particularly useful for our purpose.</p>

<p>The structure <code class="language-plaintext highlighter-rouge">STARTUPINFOEX</code> is shown below.</p>

<div class="language-c++ highlighter-rouge"><div class="code-header">
        <span data-label-text="C++"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre><span class="k">typedef</span> <span class="k">struct</span> <span class="nc">_STARTUPINFOEXW</span> <span class="p">{</span>
    <span class="n">STARTUPINFOW</span> <span class="n">StartupInfo</span><span class="p">;</span>
    <span class="n">LPPROC_THREAD_ATTRIBUTE_LIST</span> <span class="n">lpAttributeList</span><span class="p">;</span>
<span class="p">}</span> <span class="n">STARTUPINFOEXW</span><span class="p">,</span> <span class="o">*</span><span class="n">LPSTARTUPINFOEXW</span><span class="p">;</span>
</pre></td></tr></tbody></table></code></div></div>

<ul>
  <li><strong>Startupinfo</strong>: same as Startupinfo structure which was used to create a normal process.</li>
  <li><strong>lpAttributeList</strong>: An attribute list. This list is created by the <a href="https://learn.microsoft.com/en-us/windows/desktop/api/processthreadsapi/nf-processthreadsapi-initializeprocthreadattributelist">InitializeProcThreadAttributeList</a> function.</li>
</ul>

<p>As the <code class="language-plaintext highlighter-rouge">InitializeProcThreadAttributeList</code> function creates an attribute list for the process in inside <code class="language-plaintext highlighter-rouge">STARTUPINFOEX</code> structure. we have to take a look at it.</p>

<h2 id="initializeprocthreadattributelist"><span class="me-2">InitializeProcThreadAttributeList</span><a href="#initializeprocthreadattributelist" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p><a href="https://learn.microsoft.com/en-us/windows/win32/api/processthreadsapi/nf-processthreadsapi-initializeprocthreadattributelist"><code class="language-plaintext highlighter-rouge">InitializeProcThreadAttributeList</code></a> is responsible for Initializing the specified list of attributes for process and thread creation.</p>

<p>The <code class="language-plaintext highlighter-rouge">InitializeProcThreadAttributeList</code> function is shown below:</p>

<div class="language-c highlighter-rouge"><div class="code-header">
        <span data-label-text="C"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre><span class="n">BOOL</span> <span class="nf">InitializeProcThreadAttributeList</span><span class="p">(</span>
  <span class="p">[</span><span class="n">out</span><span class="p">,</span> <span class="n">optional</span><span class="p">]</span> <span class="n">LPPROC_THREAD_ATTRIBUTE_LIST</span> <span class="n">lpAttributeList</span><span class="p">,</span>
  <span class="p">[</span><span class="n">in</span><span class="p">]</span>            <span class="n">DWORD</span>                        <span class="n">dwAttributeCount</span><span class="p">,</span>
                  <span class="n">DWORD</span>                        <span class="n">dwFlags</span><span class="p">,</span>
  <span class="p">[</span><span class="n">in</span><span class="p">,</span> <span class="n">out</span><span class="p">]</span>       <span class="n">PSIZE_T</span>                      <span class="n">lpSize</span>
<span class="p">);</span>
</pre></td></tr></tbody></table></code></div></div>

<p>parameters:</p>

<ul>
  <li><strong>lpAttributeList</strong>: A pointer to the attribute list.</li>
  <li><strong>dwAttributeCount</strong>: The number of attributes to set.</li>
  <li><strong>dwFlags</strong>: This parameter is reserved and must be zero.</li>
  <li><strong>lpSize</strong>: This will return the size required to set the attributes.</li>
</ul>

<p>The <code class="language-plaintext highlighter-rouge">dwAttributeCount</code>will be set to 1 since only one attribute is needed.</p>

<p>According to the microsoft the initial call to this function will return an error by design which will return the size required to allocate enough space for the data in the <code class="language-plaintext highlighter-rouge">lpAttributelist</code> buffer and call the function again to initialize the buffer. next the <a href="https://learn.microsoft.com/en-us/windows/win32/api/processthreadsapi/nf-processthreadsapi-updateprocthreadattribute"><code class="language-plaintext highlighter-rouge">UpdateProcThreadAttribute</code></a>function will be responsible for adding attributes to the list.</p>

<p><a href="/assets/img/2024-07-16-png_spoofing_parent_process/remarks_initialize_proc_thread.png" class="popup img-link  shimmer"><img src="/assets/img/2024-07-16-png_spoofing_parent_process/remarks_initialize_proc_thread.png" alt="Initialize_procthread" loading="lazy"></a></p>

<h2 id="updateprocthreadattribute"><span class="me-2">UpdateProcThreadAttribute</span><a href="#updateprocthreadattribute" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>The <a href="https://learn.microsoft.com/en-us/windows/win32/api/processthreadsapi/nf-processthreadsapi-updateprocthreadattribute"><code class="language-plaintext highlighter-rouge">UpdateProcThreadAttribute</code></a> function is shown below</p>

<div class="language-c highlighter-rouge"><div class="code-header">
        <span data-label-text="C"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre></td><td class="rouge-code"><pre><span class="n">BOOL</span> <span class="nf">UpdateProcThreadAttribute</span><span class="p">(</span>
  <span class="p">[</span><span class="n">in</span><span class="p">,</span> <span class="n">out</span><span class="p">]</span>       <span class="n">LPPROC_THREAD_ATTRIBUTE_LIST</span> <span class="n">lpAttributeList</span><span class="p">,</span>
  <span class="p">[</span><span class="n">in</span><span class="p">]</span>            <span class="n">DWORD</span>                        <span class="n">dwFlags</span><span class="p">,</span>
  <span class="p">[</span><span class="n">in</span><span class="p">]</span>            <span class="n">DWORD_PTR</span>                    <span class="n">Attribute</span><span class="p">,</span>
  <span class="p">[</span><span class="n">in</span><span class="p">]</span>            <span class="n">PVOID</span>                        <span class="n">lpValue</span><span class="p">,</span>
  <span class="p">[</span><span class="n">in</span><span class="p">]</span>            <span class="n">SIZE_T</span>                       <span class="n">cbSize</span><span class="p">,</span>
  <span class="p">[</span><span class="n">out</span><span class="p">,</span> <span class="n">optional</span><span class="p">]</span> <span class="n">PVOID</span>                        <span class="n">lpPreviousValue</span><span class="p">,</span>
  <span class="p">[</span><span class="n">in</span><span class="p">,</span> <span class="n">optional</span><span class="p">]</span>  <span class="n">PSIZE_T</span>                      <span class="n">lpReturnSize</span>
<span class="p">);</span>
</pre></td></tr></tbody></table></code></div></div>

<p>parameters:</p>

<ul>
  <li><strong>lpAttributeList</strong>: A pointer to the attribute list initialized by <code class="language-plaintext highlighter-rouge">InitializeProcThreadAttributeList</code>. This list contains attributes to be updated.</li>
  <li><strong>dwFlags</strong>: Reserved; must be zero.</li>
  <li>
    <p><strong>Attribute</strong>: The attribute to update. For our spoofing of PPID the <code class="language-plaintext highlighter-rouge">PROC_THREAD_ATTRIBUTE_PARENT_PROCESS</code> is required.</p>
  </li>
  <li><strong>lpValue</strong>: A pointer to the value for the attribute being updated. in our case of PPID spoofing it becomes the handle of the parent process.</li>
  <li><strong>cbSize</strong>: The size of the value pointed to by <code class="language-plaintext highlighter-rouge">lpValue</code>, in bytes.</li>
  <li><strong>lpPreviousValue</strong>: Optional. A pointer to receive the previous value of the attribute, if needed.</li>
  <li><strong>lpReturnSize</strong>: Optional. A pointer to receive the size of the previous attribute value returned in <code class="language-plaintext highlighter-rouge">lpPreviousValue</code>.</li>
</ul>

<h2 id="logic"><span class="me-2">LOGIC</span><a href="#logic" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<ol>
  <li>call <code class="language-plaintext highlighter-rouge">InitializeProcThreadAttributeList</code> to set the number of attributes to be set and allocate enough space for the attributelist.</li>
  <li>call <code class="language-plaintext highlighter-rouge">UpdateProcThreadAttribute</code> with <code class="language-plaintext highlighter-rouge">PROC_THREAD_ATTRIBUTE_PARENT_PROCESS</code> to initialize the attribute.</li>
  <li>call <code class="language-plaintext highlighter-rouge">CreateProcessW</code> with the <code class="language-plaintext highlighter-rouge">EXTENDED_STARTUPINFO_PRESENT</code> flag and utilize the <code class="language-plaintext highlighter-rouge">STARTUPINFOEXW</code> structure that has been initialized using <code class="language-plaintext highlighter-rouge">InitializeProcThreadAttributeList</code> and updated using <code class="language-plaintext highlighter-rouge">UpdateProcThreadAttribute</code></li>
</ol>

<h2 id="parentpidspoofing-function"><span class="me-2">ParentPIDSpoofing function</span><a href="#parentpidspoofing-function" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p><code class="language-plaintext highlighter-rouge">ParentPIDSpoofing</code> is a function that creates process with Spoofed PPID.</p>

<p>parameters:</p>

<ul>
  <li><strong>hprocess</strong>: handle of the parent process whose PID is to be spoofed.</li>
  <li><strong>newprocessname</strong>: name of the process to create.</li>
  <li><strong>hnewprocess</strong>: A pointer to the handle which receives handle to the newly created process.</li>
  <li><strong>dwnewPID</strong>: A pointer to the PID which receives PID of the newly created process.</li>
</ul>

<div class="language-c highlighter-rouge"><div class="code-header">
        <span data-label-text="C"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
</pre></td><td class="rouge-code"><pre>
    <span class="n">BOOL</span> <span class="nf">ParentPIDSpoofing</span><span class="p">(</span><span class="n">handle</span> <span class="n">hprocess</span><span class="p">,</span> <span class="n">LPWSTR</span> <span class="n">newprocessname</span><span class="p">,</span> <span class="n">HANDLE</span><span class="o">*</span> <span class="n">hnewprocess</span><span class="p">,</span> <span class="n">DWORD</span> <span class="o">*</span><span class="n">dwnewPID</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">STARTUPINFOEXW</span> <span class="n">SI</span> <span class="o">=</span> <span class="p">{</span> <span class="mi">0</span> <span class="p">};</span>
    <span class="n">PROCESS_INFORMATION</span> <span class="n">PI</span> <span class="o">=</span> <span class="p">{</span> <span class="mi">0</span> <span class="p">};</span>
    <span class="n">SI</span><span class="p">.</span><span class="n">StartupInfo</span><span class="p">.</span><span class="n">cb</span> <span class="o">=</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">STARTUPINFOW</span><span class="p">);</span>
    <span class="n">SIZE_T</span> <span class="n">Attributelist</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="n">SI</span><span class="p">.</span><span class="n">StartupInfo</span><span class="p">.</span><span class="n">cb</span> <span class="o">=</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">STARTUPINFOEXW</span><span class="p">);</span>
    <span class="n">InitializeProcThreadAttributeList</span><span class="p">(</span><span class="nb">NULL</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">Attributelist</span><span class="p">);</span>
    <span class="n">SI</span><span class="p">.</span><span class="n">lpAttributeList</span> <span class="o">=</span> <span class="p">(</span><span class="n">LPPROC_THREAD_ATTRIBUTE_LIST</span><span class="p">)</span><span class="n">HeapAlloc</span><span class="p">(</span><span class="n">GetProcessHeap</span><span class="p">(),</span> <span class="n">HEAP_ZERO_MEMORY</span><span class="p">,</span> <span class="n">Attributelist</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">SI</span><span class="p">.</span><span class="n">lpAttributeList</span> <span class="o">==</span> <span class="nb">NULL</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"Heap alloc failed with error no %x</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">GetLastError</span><span class="p">());</span>
    <span class="k">return</span> <span class="n">FALSE</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">InitializeProcThreadAttributeList</span><span class="p">(</span><span class="n">SI</span><span class="p">.</span><span class="n">lpAttributeList</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">Attributelist</span><span class="p">))</span> <span class="p">{</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"InitializeProcThreadAttirbuteList failed with error no %x</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">GetLastError</span><span class="p">());</span>
    <span class="k">return</span> <span class="n">FALSE</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">UpdateProcThreadAttribute</span><span class="p">(</span><span class="n">SI</span><span class="p">.</span><span class="n">lpAttributeList</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">PROC_THREAD_ATTRIBUTE_PARENT_PROCESS</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">hprocess</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">hprocess</span><span class="p">),</span> <span class="nb">NULL</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">))</span> <span class="p">{</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"UpdateProcThreadAttirbute failed with error no %x</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">GetLastError</span><span class="p">());</span>
    <span class="k">return</span> <span class="n">FALSE</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">CreateProcessW</span><span class="p">(</span><span class="nb">NULL</span><span class="p">,</span> <span class="n">newprocessname</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="n">FALSE</span><span class="p">,</span> <span class="n">EXTENDED_STARTUPINFO_PRESENT</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">SI</span><span class="p">.</span><span class="n">StartupInfo</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">PI</span><span class="p">))</span> <span class="p">{</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"The CreateprocessW failed with error no %x</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">GetLastError</span><span class="p">());</span>
    <span class="k">return</span> <span class="n">FALSE</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="o">*</span><span class="n">hnewprocess</span> <span class="o">=</span> <span class="n">PI</span><span class="p">.</span><span class="n">hProcess</span><span class="p">;</span>
    <span class="o">*</span><span class="n">dwnewPID</span> <span class="o">=</span> <span class="n">PI</span><span class="p">.</span><span class="n">dwProcessId</span><span class="p">;</span>
    <span class="k">return</span> <span class="n">TRUE</span><span class="p">;</span>
    <span class="p">}</span>
</pre></td></tr></tbody></table></code></div></div>

<h2 id="execution"><span class="me-2">Execution</span><a href="#execution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>Create the child process <code class="language-plaintext highlighter-rouge">Notepad.exe</code> with the parent process being <code class="language-plaintext highlighter-rouge">svchost.exe</code>, which has a PID of 4312.</p>

<p><code class="language-plaintext highlighter-rouge">NOTE: svchost.exe is running with normal privileges.</code></p>

<p><a href="/assets/img/2024-07-16-png_spoofing_parent_process/1_vy-QDjqiGpMeHXHAu_D4xw.webp" class="popup img-link  shimmer"><img src="/assets/img/2024-07-16-png_spoofing_parent_process/1_vy-QDjqiGpMeHXHAu_D4xw.webp" alt="process_creation" loading="lazy"></a></p>

<p><code class="language-plaintext highlighter-rouge">Notepad.exe</code> appears to be spawned by <code class="language-plaintext highlighter-rouge">svchost.exe</code> .</p>

<p><a href="/assets/img/2024-07-16-png_spoofing_parent_process/1_vy-QDjqiGpMeHXHAu_D4xw.webp" class="popup img-link  shimmer"><img src="/assets/img/2024-07-16-png_spoofing_parent_process/1_vy-QDjqiGpMeHXHAu_D4xw.webp" alt="Parent_process" loading="lazy"></a></p>

  </div>

  <div class="post-tail-wrapper text-muted">
    <!-- categories -->
    
      <div class="post-meta mb-3">
        <i class="far fa-folder-open fa-fw me-1"></i>
        
          <a href="/categories/malware-development/">Malware Development</a>
      </div>
    

    <!-- tags -->
    
      <div class="post-tags">
        <i class="fa fa-tags fa-fw me-1"></i>
        
          <a
            href="/tags/malware-development/"
            class="post-tag no-text-decoration"
          >Malware Development</a>
        
      </div>
    

    <div
      class="
        post-tail-bottom
        d-flex justify-content-between align-items-center mt-5 pb-2
      "
    >
      <div class="license-wrapper">
        
          

          This post is licensed under 
        <a href="https://creativecommons.org/licenses/by/4.0/">
          CC BY 4.0
        </a>
         by the author.
        
      </div>

      <!-- Post sharing snippet -->

<div class="share-wrapper d-flex align-items-center">
  <span class="share-label text-muted">Share</span>
  <span class="share-icons">
    
    
    

    

      

      <a href="https://twitter.com/intent/tweet?text=Spoofing%20Parent%20Process%20ID%20(PPID)%20-%20Utsab%20Adhikari&url=http%3A%2F%2Flocalhost%3A4000%2Fposts%2Fspoofing_parent_process_id%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" aria-label="Twitter">
        <i class="fa-fw fa-brands fa-square-x-twitter"></i>
      </a>
    

      

      <a href="https://www.facebook.com/sharer/sharer.php?title=Spoofing%20Parent%20Process%20ID%20(PPID)%20-%20Utsab%20Adhikari&u=http%3A%2F%2Flocalhost%3A4000%2Fposts%2Fspoofing_parent_process_id%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" aria-label="Facebook">
        <i class="fa-fw fab fa-facebook-square"></i>
      </a>
    

      

      <a href="https://t.me/share/url?url=http%3A%2F%2Flocalhost%3A4000%2Fposts%2Fspoofing_parent_process_id%2F&text=Spoofing%20Parent%20Process%20ID%20(PPID)%20-%20Utsab%20Adhikari" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Telegram" aria-label="Telegram">
        <i class="fa-fw fab fa-telegram"></i>
      </a>
    

    <button
      id="copy-link"
      aria-label="Copy link"
      class="btn small"
      data-bs-toggle="tooltip"
      data-bs-placement="top"
      title="Copy link"
      data-title-succeed="Link copied successfully!"
    >
      <i class="fa-fw fas fa-link pe-none fs-6"></i>
    </button>
  </span>
</div>

    </div>
    <!-- .post-tail-bottom -->
  </div>
  <!-- div.post-tail-wrapper -->
</article>


            
          </main>

          <!-- panel -->
          <aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 mb-5 text-muted">
            <div class="access">
              <!-- Get 5 last posted/updated posts -->














  <section id="access-lastmod">
    <h2 class="panel-heading">Recently Updated</h2>
    <ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2">
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/Analaysis_of_Macro-Embeeded-Excel-File/">Analysis of Macro-Embedded Excel File</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/UAC_bypass_using_fodhelper/">UAC bypass using fodhelper</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/command-line-spoofing/">Command Line Spoofing</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/Windows_core_processes/">Windows Core Processes</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/local_function_stomping_injection/">Local Function Stomping Injection</a>
        </li>
      
    </ul>
  </section>
  <!-- #access-lastmod -->


              <!-- The trending tags list -->















  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
        
        



  <section>
    <h2 class="panel-heading">Trending Tags</h2>
    <div class="d-flex flex-wrap mt-3 mb-1 me-3">
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/malware-development/">Malware Development</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/windows-internals/">Windows Internals</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/malware-analysis/">Malware Analysis</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/uac-bypass/">UAC Bypass</a>
      
    </div>
  </section>


            </div>

            
              
              



  <section id="toc-wrapper" class="d-none ps-0 pe-4">
    <h2 class="panel-heading ps-3 mb-2">Contents</h2>
    <nav id="toc"></nav>
  </section>


            
          </aside>
        </div>

        <div class="row">
          <!-- tail -->
          <div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4">
            
              
              <!-- Recommend the other 3 posts according to the tags and categories of the current post. -->

<!-- The total size of related posts -->


<!-- An random integer that bigger than 0 -->


<!-- Equals to TAG_SCORE / {max_categories_hierarchy} -->















  

  
    
  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  











  <aside id="related-posts" aria-labelledby="related-label">
    <h3 class="mb-4" id="related-label">Further Reading</h3>
    <nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4">
      
        <article class="col">
          <a href="/posts/UAC_bypass_using_fodhelper/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1724233740"
  data-df="ll"
  
>
  Aug 21, 2024
</time>

              <h4 class="pt-0 my-2">UAC bypass using fodhelper</h4>
              <div class="text-muted">
                <p>User Account Control (UAC) is a crucial security feature in Windows designed to prevent unauthorized changes to the operating system. However, vulnerabilities in UAC can be exploited to escalate pr...</p>
              </div>
            </div>
          </a>
        </article>
      
        <article class="col">
          <a href="/posts/command-line-spoofing/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1722332940"
  data-df="ll"
  
>
  Jul 30, 2024
</time>

              <h4 class="pt-0 my-2">Command Line Spoofing</h4>
              <div class="text-muted">
                <p>Command line spoofing is a technique where the instructions given to a program through the command line are altered or replaced. To make this clearer, let’s break it down:

When a program runs, it ...</p>
              </div>
            </div>
          </a>
        </article>
      
        <article class="col">
          <a href="/posts/local_function_stomping_injection/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1722260820"
  data-df="ll"
  
>
  Jul 29, 2024
</time>

              <h4 class="pt-0 my-2">Local Function Stomping Injection</h4>
              <div class="text-muted">
                <p>Function Stomping

Function stomping typically refers to overwriting the code or data of a function with different content in its memory space. This can be done to modify the behavior of the functi...</p>
              </div>
            </div>
          </a>
        </article>
      
    </nav>
  </aside>
  <!-- #related-posts -->


            
              
              <!-- Navigation buttons at the bottom of the post. -->

<nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation">
  
  

  
    <div class="btn btn-outline-primary disabled" aria-label="Older">
      <p>-</p>
    </div>
  

  
    <a
      href="/posts/local_function_stomping_injection/"
      class="btn btn-outline-primary"
      aria-label="Newer"
    >
      <p>Local Function Stomping Injection</p>
    </a>
  
</nav>

            
              
              <!-- The comments switcher -->


            

            <!-- The Footer -->

<footer
  aria-label="Site Info"
  class="
    d-flex flex-column justify-content-center text-muted
    flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3
  "
>
  <p>©
    <time>2024</time>

    
      <a href="https://twitter.com/username">Utsab Adhikari</a>.
    

    
      <span
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author."
      >Some rights reserved.</span>
    
  </p>

  <p>Using the <a
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="v7.0.1"
        href="https://github.com/cotes2020/jekyll-theme-chirpy"
        target="_blank"
        rel="noopener"
      >Chirpy</a> theme for <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>.
  </p>
</footer>

          </div>
        </div>

        <!-- The Search results -->

<div id="search-result-wrapper" class="d-flex justify-content-center d-none">
  <div class="col-11 content">
    <div id="search-hints">
      <!-- The trending tags list -->















  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
        
        



  <section>
    <h2 class="panel-heading">Trending Tags</h2>
    <div class="d-flex flex-wrap mt-3 mb-1 me-3">
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/malware-development/">Malware Development</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/windows-internals/">Windows Internals</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/malware-analysis/">Malware Analysis</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/uac-bypass/">UAC Bypass</a>
      
    </div>
  </section>


    </div>
    <div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div>
  </div>
</div>

      </div>

      <aside aria-label="Scroll to Top">
        <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow">
          <i class="fas fa-angle-up"></i>
        </button>
      </aside>
    </div>

    <div id="mask"></div>

    
      <aside
  id="notification"
  class="toast"
  role="alert"
  aria-live="assertive"
  aria-atomic="true"
  data-bs-animation="true"
  data-bs-autohide="false"
>
  <div class="toast-header">
    <button
      type="button"
      class="btn-close ms-auto"
      data-bs-dismiss="toast"
      aria-label="Close"
    ></button>
  </div>
  <div class="toast-body text-center pt-0">
    <p class="px-2 mb-3">A new version of content is available.</p>
    <button type="button" class="btn btn-primary" aria-label="Update">
      Update
    </button>
  </div>
</aside>

    

    <!-- JavaScripts -->
    <!-- JS selector for site. -->

<!-- commons -->



<!-- layout specified -->




  

  
    <!-- image lazy-loading & popup & clipboard -->
    
  















  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  



  <script src="https://cdn.jsdelivr.net/combine/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/glightbox@3.3.0/dist/js/glightbox.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.11/dayjs.min.js,npm/dayjs@1.11.11/locale/en.min.js,npm/dayjs@1.11.11/plugin/relativeTime.min.js,npm/dayjs@1.11.11/plugin/localizedFormat.min.js,npm/tocbot@4.27.20/dist/tocbot.min.js"></script>






<script src="/assets/js/dist/post.min.js"></script>



<!-- Pageviews -->

  

  







    <!--
  Jekyll Simple Search loader
  See: <https://github.com/christian-fei/Simple-Jekyll-Search>
-->





<script>SimpleJekyllSearch({
    searchInput: document.getElementById('search-input'),
    resultsContainer: document.getElementById('search-results'),
    json: '/assets/js/data/search.json',
    searchResultTemplate: '  <article class="px-1 px-sm-2 px-lg-4 px-xl-0">    <header>      <h2><a href="{url}">{title}</a></h2>      <div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1">        {categories}        {tags}      </div>    </header>    <p>{snippet}</p>  </article>',
    noResultsText: '<p class="mt-5">Oops! No results found.</p>',
    templateMiddleware: function(prop, value, template) {
      if (prop === 'categories') {
        if (value === '') {
          return `${value}`;
        } else {
          return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`;
        }
      }

      if (prop === 'tags') {
        if (value === '') {
          return `${value}`;
        } else {
          return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`;
        }
      }
    }
  });
</script>

  </body>
</html>

